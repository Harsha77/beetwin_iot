function u(e){return new Promise((n,t)=>{e.oncomplete=e.onsuccess=()=>n(e.result),e.onabort=e.onerror=()=>t(e.error)})}function l(e,n){let t;const r=()=>{if(t)return t;const o=indexedDB.open(e);return o.onupgradeneeded=()=>o.result.createObjectStore(n),t=u(o),t.then(i=>{i.onclose=()=>t=void 0},()=>{}),t};return(o,i)=>r().then(s=>i(s.transaction(n,o).objectStore(n)))}let a;function c(){return a||(a=l("keyval-store","keyval")),a}function d(e,n=c()){return n("readonly",t=>u(t.get(e)))}function p(e,n,t=c()){return t("readwrite",r=>(r.put(n,e),u(r.transaction)))}function h(e,n=c()){return n("readwrite",t=>(e.forEach(r=>t.put(r[1],r[0])),u(t.transaction)))}function y(e,n=c()){return n("readwrite",t=>(t.delete(e),u(t.transaction)))}function f(e,n){return e.openCursor().onsuccess=function(){this.result&&(n(this.result),this.result.continue())},u(e.transaction)}function g(e=c()){return e("readonly",n=>{if(n.getAllKeys)return u(n.getAllKeys());const t=[];return f(n,r=>t.push(r.key)).then(()=>t)})}export{h as a,y as d,d as g,g as k,p as s};
