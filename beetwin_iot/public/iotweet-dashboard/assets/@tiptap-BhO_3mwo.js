import{r as An,f as Ft,t as En,m as Sn,h as Kt,v as mt,p as yt}from"./@vue-6KHaxNJ6.js";import{d as Tn}from"./prosemirror-dropcursor-DdDve3OF.js";import{g as Cn}from"./prosemirror-gapcursor-B9ns80ZN.js";import{h as On,r as _n,u as Ln}from"./prosemirror-history-4Kh61WTt.js";import{N as he,P as J,a as Q,S as pe,T as G,A as Nn}from"./prosemirror-state-C0OblyT9.js";import{D as Ye,a as Ze}from"./prosemirror-view-Dw0L6lI7.js";import{c as Rn,t as In,C as qt,f as $n,g as bt,s as Pn,m as Mt,a as kt,b as Bn,d as xt,e as Hn,h as Dn,i as jn,j as Wn,k as zn,l as Fn,n as Kn}from"./prosemirror-tables-Cnk26J7e.js";import{f as Ut,r as wt,t as qn,a as Un}from"./linkifyjs-85EWwGDS.js";import{F as be,S as Vn,N as Gn,a as Qn,D as qe}from"./prosemirror-model-CDAhqB4x.js";import{f as Jn,c as et,T as Xn,a as $e,j as Vt,l as Yn,R as Zn,b as es}from"./prosemirror-transform-DiPrUp-3.js";import{w as ts,s as vt,a as ns,b as ss,c as rs,d as os,e as is,n as as,l as ls,f as cs,j as us,g as ds,h as ps,i as fs,k as hs,m as gs,o as ms,p as ys,q as bs}from"./prosemirror-commands-CZrlb0Rg.js";import{w as Ms,s as ks,l as xs}from"./prosemirror-schema-list-CPI4UhYk.js";function Gt(e){const{state:t,transaction:n}=e;let{selection:s}=n,{doc:r}=n,{storedMarks:o}=n;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return o},get selection(){return s},get doc(){return r},get tr(){return s=n.selection,r=n.doc,o=n.storedMarks,n}}}class ws{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:n,state:s}=this,{view:r}=n,{tr:o}=s,i=this.buildProps(o);return Object.fromEntries(Object.entries(t).map(([a,l])=>[a,(...u)=>{const d=l(...u)(i);return!o.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(o),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,n=!0){const{rawCommands:s,editor:r,state:o}=this,{view:i}=r,a=[],l=!!t,c=t||o.tr,u=()=>(!l&&n&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(c),a.every(p=>p===!0)),d={...Object.fromEntries(Object.entries(s).map(([p,h])=>[p,(...f)=>{const g=this.buildProps(c,n),y=h(...f)(g);return a.push(y),d}])),run:u};return d}createCan(t){const{rawCommands:n,state:s}=this,r=!1,o=t||s.tr,i=this.buildProps(o,r);return{...Object.fromEntries(Object.entries(n).map(([l,c])=>[l,(...u)=>c(...u)({...i,dispatch:void 0})])),chain:()=>this.createChain(o,r)}}buildProps(t,n=!0){const{rawCommands:s,editor:r,state:o}=this,{view:i}=r,a={tr:t,editor:r,view:i,state:Gt({state:o,transaction:t}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(t,n),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(s).map(([l,c])=>[l,(...u)=>c(...u)(a)]))}};return a}}function z(e,t,n){return e.config[t]===void 0&&e.parent?z(e.parent,t,n):typeof e.config[t]=="function"?e.config[t].bind({...n,parent:e.parent?z(e.parent,t,n):null}):e.config[t]}function vs(e){const t=e.filter(r=>r.type==="extension"),n=e.filter(r=>r.type==="node"),s=e.filter(r=>r.type==="mark");return{baseExtensions:t,nodeExtensions:n,markExtensions:s}}function F(e,t){if(typeof e=="string"){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}function R(...e){return e.filter(t=>!!t).reduce((t,n)=>{const s={...t};return Object.entries(n).forEach(([r,o])=>{if(!s[r]){s[r]=o;return}if(r==="class"){const a=o?String(o).split(" "):[],l=s[r]?s[r].split(" "):[],c=a.filter(u=>!l.includes(u));s[r]=[...l,...c].join(" ")}else if(r==="style"){const a=o?o.split(";").map(u=>u.trim()).filter(Boolean):[],l=s[r]?s[r].split(";").map(u=>u.trim()).filter(Boolean):[],c=new Map;l.forEach(u=>{const[d,p]=u.split(":").map(h=>h.trim());c.set(d,p)}),a.forEach(u=>{const[d,p]=u.split(":").map(h=>h.trim());c.set(d,p)}),s[r]=Array.from(c.entries()).map(([u,d])=>`${u}: ${d}`).join("; ")}else s[r]=o}),s},{})}function As(e){return typeof e=="function"}function P(e,t=void 0,...n){return As(e)?t?e.bind(t)(...n):e(...n):e}function Es(e){return Object.prototype.toString.call(e)==="[object RegExp]"}class Ee{constructor(t){this.find=t.find,this.handler=t.handler}}function Ss(e){return Object.prototype.toString.call(e).slice(8,-1)}function Le(e){return Ss(e)!=="Object"?!1:e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function De(e,t){const n={...e};return Le(e)&&Le(t)&&Object.keys(t).forEach(s=>{Le(t[s])&&Le(e[s])?n[s]=De(e[s],t[s]):n[s]=t[s]}),n}class se{constructor(t={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=P(z(this,"addOptions",{name:this.name}))),this.storage=P(z(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new se(t)}configure(t={}){const n=this.extend({...this.config,addOptions:()=>De(this.options,t)});return n.name=this.name,n.parent=this.parent,n}extend(t={}){const n=new se(t);return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=P(z(n,"addOptions",{name:n.name})),n.storage=P(z(n,"addStorage",{name:n.name,options:n.options})),n}static handleExit({editor:t,mark:n}){const{tr:s}=t.state,r=t.state.selection.$from;if(r.pos===r.end()){const i=r.marks();if(!!!i.find(c=>(c==null?void 0:c.type.name)===n.name))return!1;const l=i.find(c=>(c==null?void 0:c.type.name)===n.name);return l&&s.removeStoredMark(l),s.insertText(" ",r.pos),t.view.dispatch(s),!0}return!1}}class Ts{constructor(t){this.find=t.find,this.handler=t.handler}}class D{constructor(t={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=P(z(this,"addOptions",{name:this.name}))),this.storage=P(z(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new D(t)}configure(t={}){const n=this.extend({...this.config,addOptions:()=>De(this.options,t)});return n.name=this.name,n.parent=this.parent,n}extend(t={}){const n=new D({...this.config,...t});return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=P(z(n,"addOptions",{name:n.name})),n.storage=P(z(n,"addStorage",{name:n.name,options:n.options})),n}}function Cs(e,t,n){const{from:s,to:r}=t,{blockSeparator:o=`

`,textSerializers:i={}}=n||{};let a="";return e.nodesBetween(s,r,(l,c,u,d)=>{var p;l.isBlock&&c>s&&(a+=o);const h=i==null?void 0:i[l.type.name];if(h)return u&&(a+=h({node:l,pos:c,parent:u,index:d,range:t})),!1;l.isText&&(a+=(p=l==null?void 0:l.text)===null||p===void 0?void 0:p.slice(Math.max(s,c)-c,r-c))}),a}function Os(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,t])=>t.spec.toText).map(([t,n])=>[t,n.spec.toText]))}D.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new J({key:new Q("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:e}=this,{state:t,schema:n}=e,{doc:s,selection:r}=t,{ranges:o}=r,i=Math.min(...o.map(u=>u.$from.pos)),a=Math.max(...o.map(u=>u.$to.pos)),l=Os(n);return Cs(s,{from:i,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}});const _s=()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{var n;e.isDestroyed||(t.dom.blur(),(n=window==null?void 0:window.getSelection())===null||n===void 0||n.removeAllRanges())}),!0),Ls=(e=!1)=>({commands:t})=>t.setContent("",e),Ns=()=>({state:e,tr:t,dispatch:n})=>{const{selection:s}=t,{ranges:r}=s;return n&&r.forEach(({$from:o,$to:i})=>{e.doc.nodesBetween(o.pos,i.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:u}=t,d=c.resolve(u.map(l)),p=c.resolve(u.map(l+a.nodeSize)),h=d.blockRange(p);if(!h)return;const b=Yn(h);if(a.type.isTextblock){const{defaultType:f}=d.parent.contentMatchAt(d.index());t.setNodeMarkup(h.start,f)}(b||b===0)&&t.lift(h,b)})}),!0},Rs=e=>t=>e(t),Is=()=>({state:e,dispatch:t})=>bs(e,t),$s=(e,t)=>({editor:n,tr:s})=>{const{state:r}=n,o=r.doc.slice(e.from,e.to);s.deleteRange(e.from,e.to);const i=s.mapping.map(t);return s.insert(i,o.content),s.setSelection(new G(s.doc.resolve(i-1))),!0},Ps=()=>({tr:e,dispatch:t})=>{const{selection:n}=e,s=n.$anchor.node();if(s.content.size>0)return!1;const r=e.selection.$anchor;for(let o=r.depth;o>0;o-=1)if(r.node(o).type===s.type){if(t){const a=r.before(o),l=r.after(o);e.delete(a,l).scrollIntoView()}return!0}return!1},Bs=e=>({tr:t,state:n,dispatch:s})=>{const r=F(e,n.schema),o=t.selection.$anchor;for(let i=o.depth;i>0;i-=1)if(o.node(i).type===r){if(s){const l=o.before(i),c=o.after(i);t.delete(l,c).scrollIntoView()}return!0}return!1},Hs=e=>({tr:t,dispatch:n})=>{const{from:s,to:r}=e;return n&&t.delete(s,r),!0},Ds=()=>({state:e,dispatch:t})=>ys(e,t),js=()=>({commands:e})=>e.keyboardShortcut("Enter"),Ws=()=>({state:e,dispatch:t})=>ms(e,t);function Be(e,t,n={strict:!0}){const s=Object.keys(t);return s.length?s.every(r=>n.strict?t[r]===e[r]:Es(t[r])?t[r].test(e[r]):t[r]===e[r]):!0}function Qt(e,t,n={}){return e.find(s=>s.type===t&&Be(Object.fromEntries(Object.keys(n).map(r=>[r,s.attrs[r]])),n))}function At(e,t,n={}){return!!Qt(e,t,n)}function tt(e,t,n){var s;if(!e||!t)return;let r=e.parent.childAfter(e.parentOffset);if((!r.node||!r.node.marks.some(u=>u.type===t))&&(r=e.parent.childBefore(e.parentOffset)),!r.node||!r.node.marks.some(u=>u.type===t)||(n=n||((s=r.node.marks[0])===null||s===void 0?void 0:s.attrs),!Qt([...r.node.marks],t,n)))return;let i=r.index,a=e.start()+r.offset,l=i+1,c=a+r.node.nodeSize;for(;i>0&&At([...e.parent.child(i-1).marks],t,n);)i-=1,a-=e.parent.child(i).nodeSize;for(;l<e.parent.childCount&&At([...e.parent.child(l).marks],t,n);)c+=e.parent.child(l).nodeSize,l+=1;return{from:a,to:c}}function ie(e,t){if(typeof e=="string"){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}const zs=(e,t={})=>({tr:n,state:s,dispatch:r})=>{const o=ie(e,s.schema),{doc:i,selection:a}=n,{$from:l,from:c,to:u}=a;if(r){const d=tt(l,o,t);if(d&&d.from<=c&&d.to>=u){const p=G.create(i,d.from,d.to);n.setSelection(p)}}return!0},Fs=e=>t=>{const n=typeof e=="function"?e(t):e;for(let s=0;s<n.length;s+=1)if(n[s](t))return!0;return!1};function Jt(e){return e instanceof G}function de(e=0,t=0,n=0){return Math.min(Math.max(e,t),n)}function Ks(e,t=null){if(!t)return null;const n=pe.atStart(e),s=pe.atEnd(e);if(t==="start"||t===!0)return n;if(t==="end")return s;const r=n.from,o=s.to;return t==="all"?G.create(e,de(0,r,o),de(e.content.size,r,o)):G.create(e,de(t,r,o),de(t,r,o))}function Xt(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function je(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const qs=(e=null,t={})=>({editor:n,view:s,tr:r,dispatch:o})=>{t={scrollIntoView:!0,...t};const i=()=>{(je()||Xt())&&s.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(s.focus(),t!=null&&t.scrollIntoView&&n.commands.scrollIntoView())})};if(s.hasFocus()&&e===null||e===!1)return!0;if(o&&e===null&&!Jt(n.state.selection))return i(),!0;const a=Ks(r.doc,e)||n.state.selection,l=n.state.selection.eq(a);return o&&(l||r.setSelection(a),l&&r.storedMarks&&r.setStoredMarks(r.storedMarks),i()),!0},Us=(e,t)=>n=>e.every((s,r)=>t(s,{...n,index:r})),Vs=(e,t)=>({tr:n,commands:s})=>s.insertContentAt({from:n.selection.from,to:n.selection.to},e,t),Yt=e=>{const t=e.childNodes;for(let n=t.length-1;n>=0;n-=1){const s=t[n];s.nodeType===3&&s.nodeValue&&/^(\n\s\s|\n)$/.test(s.nodeValue)?e.removeChild(s):s.nodeType===1&&Yt(s)}return e};function Ne(e){const t=`<body>${e}</body>`,n=new window.DOMParser().parseFromString(t,"text/html").body;return Yt(n)}function xe(e,t,n){if(e instanceof Gn||e instanceof be)return e;n={slice:!0,parseOptions:{},...n};const s=typeof e=="object"&&e!==null,r=typeof e=="string";if(s)try{if(Array.isArray(e)&&e.length>0)return be.fromArray(e.map(a=>t.nodeFromJSON(a)));const i=t.nodeFromJSON(e);return n.errorOnInvalidContent&&i.check(),i}catch(o){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",o),xe("",t,n)}if(r){if(n.errorOnInvalidContent){let i=!1,a="";const l=new Qn({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(i=!0,a=typeof c=="string"?c:c.outerHTML,null)}]}})});if(n.slice?qe.fromSchema(l).parseSlice(Ne(e),n.parseOptions):qe.fromSchema(l).parse(Ne(e),n.parseOptions),n.errorOnInvalidContent&&i)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}const o=qe.fromSchema(t);return n.slice?o.parseSlice(Ne(e),n.parseOptions).content:o.parse(Ne(e),n.parseOptions)}return xe("",t,n)}function Gs(e,t,n){const s=e.steps.length-1;if(s<t)return;const r=e.steps[s];if(!(r instanceof Zn||r instanceof es))return;const o=e.mapping.maps[s];let i=0;o.forEach((a,l,c,u)=>{i===0&&(i=u)}),e.setSelection(pe.near(e.doc.resolve(i),n))}const Qs=e=>!("type"in e),Js=(e,t,n)=>({tr:s,dispatch:r,editor:o})=>{var i;if(r){n={parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let a;const l=g=>{o.emit("contentError",{editor:o,error:g,disableCollaboration:()=>{o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}})},c={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!o.options.enableContentCheck&&o.options.emitContentError)try{xe(t,o.schema,{parseOptions:c,errorOnInvalidContent:!0})}catch(g){l(g)}try{a=xe(t,o.schema,{parseOptions:c,errorOnInvalidContent:(i=n.errorOnInvalidContent)!==null&&i!==void 0?i:o.options.enableContentCheck})}catch(g){return l(g),!1}let{from:u,to:d}=typeof e=="number"?{from:e,to:e}:{from:e.from,to:e.to},p=!0,h=!0;if((Qs(a)?a:[a]).forEach(g=>{g.check(),p=p?g.isText&&g.marks.length===0:!1,h=h?g.isBlock:!1}),u===d&&h){const{parent:g}=s.doc.resolve(u);g.isTextblock&&!g.type.spec.code&&!g.childCount&&(u-=1,d+=1)}let f;if(p){if(Array.isArray(t))f=t.map(g=>g.text||"").join("");else if(t instanceof be){let g="";t.forEach(y=>{y.text&&(g+=y.text)}),f=g}else typeof t=="object"&&t&&t.text?f=t.text:f=t;s.insertText(f,u,d)}else f=a,s.replaceWith(u,d,f);n.updateSelection&&Gs(s,s.steps.length-1,-1),n.applyInputRules&&s.setMeta("applyInputRules",{from:u,text:f}),n.applyPasteRules&&s.setMeta("applyPasteRules",{from:u,text:f})}return!0},Xs=()=>({state:e,dispatch:t})=>us(e,t),Ys=()=>({state:e,dispatch:t})=>hs(e,t),Zs=()=>({state:e,dispatch:t})=>gs(e,t),er=()=>({state:e,dispatch:t})=>fs(e,t),tr=()=>({state:e,dispatch:t,tr:n})=>{try{const s=Vt(e.doc,e.selection.$from.pos,-1);return s==null?!1:(n.join(s,2),t&&t(n),!0)}catch(s){return!1}},nr=()=>({state:e,dispatch:t,tr:n})=>{try{const s=Vt(e.doc,e.selection.$from.pos,1);return s==null?!1:(n.join(s,2),t&&t(n),!0)}catch(s){return!1}},sr=()=>({state:e,dispatch:t})=>ps(e,t),rr=()=>({state:e,dispatch:t})=>ds(e,t);function Zt(){return typeof navigator!="undefined"?/Mac/.test(navigator.platform):!1}function or(e){const t=e.split(/-(?!$)/);let n=t[t.length-1];n==="Space"&&(n=" ");let s,r,o,i;for(let a=0;a<t.length-1;a+=1){const l=t[a];if(/^(cmd|meta|m)$/i.test(l))i=!0;else if(/^a(lt)?$/i.test(l))s=!0;else if(/^(c|ctrl|control)$/i.test(l))r=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))je()||Zt()?i=!0:r=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return s&&(n=`Alt-${n}`),r&&(n=`Ctrl-${n}`),i&&(n=`Meta-${n}`),o&&(n=`Shift-${n}`),n}const ir=e=>({editor:t,view:n,tr:s,dispatch:r})=>{const o=or(e).split(/-(?!$)/),i=o.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:i==="Space"?" ":i,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),l=t.captureTransaction(()=>{n.someProp("handleKeyDown",c=>c(n,a))});return l==null||l.steps.forEach(c=>{const u=c.map(s.mapping);u&&r&&s.maybeStep(u)}),!0};function nt(e,t,n={}){const{from:s,to:r,empty:o}=e.selection,i=t?F(t,e.schema):null,a=[];e.doc.nodesBetween(s,r,(d,p)=>{if(d.isText)return;const h=Math.max(s,p),b=Math.min(r,p+d.nodeSize);a.push({node:d,from:h,to:b})});const l=r-s,c=a.filter(d=>i?i.name===d.node.type.name:!0).filter(d=>Be(d.node.attrs,n,{strict:!1}));return o?!!c.length:c.reduce((d,p)=>d+p.to-p.from,0)>=l}const ar=(e,t={})=>({state:n,dispatch:s})=>{const r=F(e,n.schema);return nt(n,r,t)?cs(n,s):!1},lr=()=>({state:e,dispatch:t})=>ls(e,t),cr=e=>({state:t,dispatch:n})=>{const s=F(e,t.schema);return xs(s)(t,n)},ur=()=>({state:e,dispatch:t})=>as(e,t);function st(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function Et(e,t){const n=typeof t=="string"?[t]:t;return Object.keys(e).reduce((s,r)=>(n.includes(r)||(s[r]=e[r]),s),{})}const dr=(e,t)=>({tr:n,state:s,dispatch:r})=>{let o=null,i=null;const a=st(typeof e=="string"?e:e.name,s.schema);return a?(a==="node"&&(o=F(e,s.schema)),a==="mark"&&(i=ie(e,s.schema)),r&&n.selection.ranges.forEach(l=>{s.doc.nodesBetween(l.$from.pos,l.$to.pos,(c,u)=>{o&&o===c.type&&n.setNodeMarkup(u,void 0,Et(c.attrs,t)),i&&c.marks.length&&c.marks.forEach(d=>{i===d.type&&n.addMark(u,u+c.nodeSize,i.create(Et(d.attrs,t)))})})}),!0):!1},pr=()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),fr=()=>({tr:e,dispatch:t})=>{if(t){const n=new Nn(e.doc);e.setSelection(n)}return!0},hr=()=>({state:e,dispatch:t})=>is(e,t),gr=()=>({state:e,dispatch:t})=>os(e,t),mr=()=>({state:e,dispatch:t})=>rs(e,t),yr=()=>({state:e,dispatch:t})=>ss(e,t),br=()=>({state:e,dispatch:t})=>ns(e,t);function Mr(e,t,n={},s={}){return xe(e,t,{slice:!1,parseOptions:n,errorOnInvalidContent:s.errorOnInvalidContent})}const kr=(e,t=!1,n={},s={})=>({editor:r,tr:o,dispatch:i,commands:a})=>{var l,c;const{doc:u}=o;if(n.preserveWhitespace!=="full"){const d=Mr(e,r.schema,n,{errorOnInvalidContent:(l=s.errorOnInvalidContent)!==null&&l!==void 0?l:r.options.enableContentCheck});return i&&o.replaceWith(0,u.content.size,d).setMeta("preventUpdate",!t),!0}return i&&o.setMeta("preventUpdate",!t),a.insertContentAt({from:0,to:u.content.size},e,{parseOptions:n,errorOnInvalidContent:(c=s.errorOnInvalidContent)!==null&&c!==void 0?c:r.options.enableContentCheck})};function en(e,t){const n=ie(t,e.schema),{from:s,to:r,empty:o}=e.selection,i=[];o?(e.storedMarks&&i.push(...e.storedMarks),i.push(...e.selection.$head.marks())):e.doc.nodesBetween(s,r,l=>{i.push(...l.marks)});const a=i.find(l=>l.type.name===n.name);return a?{...a.attrs}:{}}function xr(e,t){const n=new Xn(e);return t.forEach(s=>{s.steps.forEach(r=>{n.step(r)})}),n}function wr(e){for(let t=0;t<e.edgeCount;t+=1){const{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function Qe(e,t){const n=[];return e.descendants((s,r)=>{t(s)&&n.push({node:s,pos:r})}),n}function vr(e,t,n){const s=[];return e.nodesBetween(t.from,t.to,(r,o)=>{n(r)&&s.push({node:r,pos:o})}),s}function tn(e,t){for(let n=e.depth;n>0;n-=1){const s=e.node(n);if(t(s))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:s}}}function rt(e){return t=>tn(t.$from,e)}function Ar(e,t){const n=F(t,e.schema),{from:s,to:r}=e.selection,o=[];e.doc.nodesBetween(s,r,a=>{o.push(a)});const i=o.reverse().find(a=>a.type.name===n.name);return i?{...i.attrs}:{}}function Er(e,t){const n=st(typeof t=="string"?t:t.name,e.schema);return n==="node"?Ar(e,t):n==="mark"?en(e,t):{}}function Sr(e,t=JSON.stringify){const n={};return e.filter(s=>{const r=t(s);return Object.prototype.hasOwnProperty.call(n,r)?!1:n[r]=!0})}function Tr(e){const t=Sr(e);return t.length===1?t:t.filter((n,s)=>!t.filter((o,i)=>i!==s).some(o=>n.oldRange.from>=o.oldRange.from&&n.oldRange.to<=o.oldRange.to&&n.newRange.from>=o.newRange.from&&n.newRange.to<=o.newRange.to))}function Cr(e){const{mapping:t,steps:n}=e,s=[];return t.maps.forEach((r,o)=>{const i=[];if(r.ranges.length)r.forEach((a,l)=>{i.push({from:a,to:l})});else{const{from:a,to:l}=n[o];if(a===void 0||l===void 0)return;i.push({from:a,to:l})}i.forEach(({from:a,to:l})=>{const c=t.slice(o).map(a,-1),u=t.slice(o).map(l),d=t.invert().map(c,-1),p=t.invert().map(u);s.push({oldRange:{from:d,to:p},newRange:{from:c,to:u}})})}),Tr(s)}function ot(e,t,n){const s=[];return e===t?n.resolve(e).marks().forEach(r=>{const o=n.resolve(e),i=tt(o,r.type);i&&s.push({mark:r,...i})}):n.nodesBetween(e,t,(r,o)=>{!r||(r==null?void 0:r.nodeSize)===void 0||s.push(...r.marks.map(i=>({from:o,to:o+r.nodeSize,mark:i})))}),s}function Pe(e,t,n){return Object.fromEntries(Object.entries(n).filter(([s])=>{const r=e.find(o=>o.type===t&&o.name===s);return r?r.attribute.keepOnSplit:!1}))}function Or(e,t,n={}){const{empty:s,ranges:r}=e.selection,o=t?ie(t,e.schema):null;if(s)return!!(e.storedMarks||e.selection.$from.marks()).filter(d=>o?o.name===d.type.name:!0).find(d=>Be(d.attrs,n,{strict:!1}));let i=0;const a=[];if(r.forEach(({$from:d,$to:p})=>{const h=d.pos,b=p.pos;e.doc.nodesBetween(h,b,(f,g)=>{if(!f.isText&&!f.marks.length)return;const y=Math.max(h,g),v=Math.min(b,g+f.nodeSize),S=v-y;i+=S,a.push(...f.marks.map(T=>({mark:T,from:y,to:v})))})}),i===0)return!1;const l=a.filter(d=>o?o.name===d.mark.type.name:!0).filter(d=>Be(d.mark.attrs,n,{strict:!1})).reduce((d,p)=>d+p.to-p.from,0),c=a.filter(d=>o?d.mark.type!==o&&d.mark.type.excludes(o):!0).reduce((d,p)=>d+p.to-p.from,0);return(l>0?l+c:l)>=i}function St(e,t){const{nodeExtensions:n}=vs(t),s=n.find(i=>i.name===e);if(!s)return!1;const r={name:s.name,options:s.options,storage:s.storage},o=P(z(s,"group",r));return typeof o!="string"?!1:o.split(" ").includes("list")}function it(e,{checkChildren:t=!0,ignoreWhitespace:n=!1}={}){var s;if(n){if(e.type.name==="hardBreak")return!0;if(e.isText)return/^\s*$/m.test((s=e.text)!==null&&s!==void 0?s:"")}if(e.isText)return!e.text;if(e.isAtom||e.isLeaf)return!1;if(e.content.childCount===0)return!0;if(t){let r=!0;return e.content.forEach(o=>{r!==!1&&(it(o,{ignoreWhitespace:n,checkChildren:t})||(r=!1))}),r}return!1}function _r(e){return e instanceof he}function Lr(e,t,n){var s;const{selection:r}=t;let o=null;if(Jt(r)&&(o=r.$cursor),o){const a=(s=e.storedMarks)!==null&&s!==void 0?s:o.marks();return!!n.isInSet(a)||!a.some(l=>l.type.excludes(n))}const{ranges:i}=r;return i.some(({$from:a,$to:l})=>{let c=a.depth===0?e.doc.inlineContent&&e.doc.type.allowsMarkType(n):!1;return e.doc.nodesBetween(a.pos,l.pos,(u,d,p)=>{if(c)return!1;if(u.isInline){const h=!p||p.type.allowsMarkType(n),b=!!n.isInSet(u.marks)||!u.marks.some(f=>f.type.excludes(n));c=h&&b}return!c}),c})}const Nr=(e,t={})=>({tr:n,state:s,dispatch:r})=>{const{selection:o}=n,{empty:i,ranges:a}=o,l=ie(e,s.schema);if(r)if(i){const c=en(s,l);n.addStoredMark(l.create({...c,...t}))}else a.forEach(c=>{const u=c.$from.pos,d=c.$to.pos;s.doc.nodesBetween(u,d,(p,h)=>{const b=Math.max(h,u),f=Math.min(h+p.nodeSize,d);p.marks.find(y=>y.type===l)?p.marks.forEach(y=>{l===y.type&&n.addMark(b,f,l.create({...y.attrs,...t}))}):n.addMark(b,f,l.create(t))})});return Lr(s,n,l)},Rr=(e,t)=>({tr:n})=>(n.setMeta(e,t),!0),Ir=(e,t={})=>({state:n,dispatch:s,chain:r})=>{const o=F(e,n.schema);let i;return n.selection.$anchor.sameParent(n.selection.$head)&&(i=n.selection.$anchor.parent.attrs),o.isTextblock?r().command(({commands:a})=>vt(o,{...i,...t})(n)?!0:a.clearNodes()).command(({state:a})=>vt(o,{...i,...t})(a,s)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},$r=e=>({tr:t,dispatch:n})=>{if(n){const{doc:s}=t,r=de(e,0,s.content.size),o=he.create(s,r);t.setSelection(o)}return!0},Pr=e=>({tr:t,dispatch:n})=>{if(n){const{doc:s}=t,{from:r,to:o}=typeof e=="number"?{from:e,to:e}:e,i=G.atStart(s).from,a=G.atEnd(s).to,l=de(r,i,a),c=de(o,i,a),u=G.create(s,l,c);t.setSelection(u)}return!0},Br=e=>({state:t,dispatch:n})=>{const s=F(e,t.schema);return ks(s)(t,n)};function Tt(e,t){const n=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(n){const s=n.filter(r=>t==null?void 0:t.includes(r.type.name));e.tr.ensureMarks(s)}}const Hr=({keepMarks:e=!0}={})=>({tr:t,state:n,dispatch:s,editor:r})=>{const{selection:o,doc:i}=t,{$from:a,$to:l}=o,c=r.extensionManager.attributes,u=Pe(c,a.node().type.name,a.node().attrs);if(o instanceof he&&o.node.isBlock)return!a.parentOffset||!$e(i,a.pos)?!1:(s&&(e&&Tt(n,r.extensionManager.splittableMarks),t.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const d=l.parentOffset===l.parent.content.size,p=a.depth===0?void 0:wr(a.node(-1).contentMatchAt(a.indexAfter(-1)));let h=d&&p?[{type:p,attrs:u}]:void 0,b=$e(t.doc,t.mapping.map(a.pos),1,h);if(!h&&!b&&$e(t.doc,t.mapping.map(a.pos),1,p?[{type:p}]:void 0)&&(b=!0,h=p?[{type:p,attrs:u}]:void 0),s){if(b&&(o instanceof G&&t.deleteSelection(),t.split(t.mapping.map(a.pos),1,h),p&&!d&&!a.parentOffset&&a.parent.type!==p)){const f=t.mapping.map(a.before()),g=t.doc.resolve(f);a.node(-1).canReplaceWith(g.index(),g.index()+1,p)&&t.setNodeMarkup(t.mapping.map(a.before()),p)}e&&Tt(n,r.extensionManager.splittableMarks),t.scrollIntoView()}return b},Dr=(e,t={})=>({tr:n,state:s,dispatch:r,editor:o})=>{var i;const a=F(e,s.schema),{$from:l,$to:c}=s.selection,u=s.selection.node;if(u&&u.isBlock||l.depth<2||!l.sameParent(c))return!1;const d=l.node(-1);if(d.type!==a)return!1;const p=o.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(r){let y=be.empty;const v=l.index(-1)?1:l.index(-2)?2:3;for(let K=l.depth-v;K>=l.depth-3;K-=1)y=be.from(l.node(K).copy(y));const S=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,T={...Pe(p,l.node().type.name,l.node().attrs),...t},I=((i=a.contentMatch.defaultType)===null||i===void 0?void 0:i.createAndFill(T))||void 0;y=y.append(be.from(a.createAndFill(null,I)||void 0));const H=l.before(l.depth-(v-1));n.replace(H,l.after(-S),new Vn(y,4-v,0));let U=-1;n.doc.nodesBetween(H,n.doc.content.size,(K,j)=>{if(U>-1)return!1;K.isTextblock&&K.content.size===0&&(U=j+1)}),U>-1&&n.setSelection(G.near(n.doc.resolve(U))),n.scrollIntoView()}return!0}const h=c.pos===l.end()?d.contentMatchAt(0).defaultType:null,b={...Pe(p,d.type.name,d.attrs),...t},f={...Pe(p,l.node().type.name,l.node().attrs),...t};n.delete(l.pos,c.pos);const g=h?[{type:a,attrs:b},{type:h,attrs:f}]:[{type:a,attrs:b}];if(!$e(n.doc,l.pos,2))return!1;if(r){const{selection:y,storedMarks:v}=s,{splittableMarks:S}=o.extensionManager,T=v||y.$to.parentOffset&&y.$from.marks();if(n.split(l.pos,2,g).scrollIntoView(),!T||!r)return!0;const I=T.filter(H=>S.includes(H.type.name));n.ensureMarks(I)}return!0},Ue=(e,t)=>{const n=rt(i=>i.type===t)(e.selection);if(!n)return!0;const s=e.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(s===void 0)return!0;const r=e.doc.nodeAt(s);return n.node.type===(r==null?void 0:r.type)&&et(e.doc,n.pos)&&e.join(n.pos),!0},Ve=(e,t)=>{const n=rt(i=>i.type===t)(e.selection);if(!n)return!0;const s=e.doc.resolve(n.start).after(n.depth);if(s===void 0)return!0;const r=e.doc.nodeAt(s);return n.node.type===(r==null?void 0:r.type)&&et(e.doc,s)&&e.join(s),!0},jr=(e,t,n,s={})=>({editor:r,tr:o,state:i,dispatch:a,chain:l,commands:c,can:u})=>{const{extensions:d,splittableMarks:p}=r.extensionManager,h=F(e,i.schema),b=F(t,i.schema),{selection:f,storedMarks:g}=i,{$from:y,$to:v}=f,S=y.blockRange(v),T=g||f.$to.parentOffset&&f.$from.marks();if(!S)return!1;const I=rt(H=>St(H.type.name,d))(f);if(S.depth>=1&&I&&S.depth-I.depth<=1){if(I.node.type===h)return c.liftListItem(b);if(St(I.node.type.name,d)&&h.validContent(I.node.content)&&a)return l().command(()=>(o.setNodeMarkup(I.pos,h),!0)).command(()=>Ue(o,h)).command(()=>Ve(o,h)).run()}return!n||!T||!a?l().command(()=>u().wrapInList(h,s)?!0:c.clearNodes()).wrapInList(h,s).command(()=>Ue(o,h)).command(()=>Ve(o,h)).run():l().command(()=>{const H=u().wrapInList(h,s),U=T.filter(K=>p.includes(K.type.name));return o.ensureMarks(U),H?!0:c.clearNodes()}).wrapInList(h,s).command(()=>Ue(o,h)).command(()=>Ve(o,h)).run()},Wr=(e,t={},n={})=>({state:s,commands:r})=>{const{extendEmptyMarkRange:o=!1}=n,i=ie(e,s.schema);return Or(s,i,t)?r.unsetMark(i,{extendEmptyMarkRange:o}):r.setMark(i,t)},zr=(e,t,n={})=>({state:s,commands:r})=>{const o=F(e,s.schema),i=F(t,s.schema),a=nt(s,o,n);let l;return s.selection.$anchor.sameParent(s.selection.$head)&&(l=s.selection.$anchor.parent.attrs),a?r.setNode(i,l):r.setNode(o,{...l,...n})},Fr=(e,t={})=>({state:n,commands:s})=>{const r=F(e,n.schema);return nt(n,r,t)?s.lift(r):s.wrapIn(r,t)},Kr=()=>({state:e,dispatch:t})=>{const n=e.plugins;for(let s=0;s<n.length;s+=1){const r=n[s];let o;if(r.spec.isInputRules&&(o=r.getState(e))){if(t){const i=e.tr,a=o.transform;for(let l=a.steps.length-1;l>=0;l-=1)i.step(a.steps[l].invert(a.docs[l]));if(o.text){const l=i.doc.resolve(o.from).marks();i.replaceWith(o.from,o.to,e.schema.text(o.text,l))}else i.delete(o.from,o.to)}return!0}}return!1},qr=()=>({tr:e,dispatch:t})=>{const{selection:n}=e,{empty:s,ranges:r}=n;return s||t&&r.forEach(o=>{e.removeMark(o.$from.pos,o.$to.pos)}),!0},Ur=(e,t={})=>({tr:n,state:s,dispatch:r})=>{var o;const{extendEmptyMarkRange:i=!1}=t,{selection:a}=n,l=ie(e,s.schema),{$from:c,empty:u,ranges:d}=a;if(!r)return!0;if(u&&i){let{from:p,to:h}=a;const b=(o=c.marks().find(g=>g.type===l))===null||o===void 0?void 0:o.attrs,f=tt(c,l,b);f&&(p=f.from,h=f.to),n.removeMark(p,h,l)}else d.forEach(p=>{n.removeMark(p.$from.pos,p.$to.pos,l)});return n.removeStoredMark(l),!0},Vr=(e,t={})=>({tr:n,state:s,dispatch:r})=>{let o=null,i=null;const a=st(typeof e=="string"?e:e.name,s.schema);return a?(a==="node"&&(o=F(e,s.schema)),a==="mark"&&(i=ie(e,s.schema)),r&&n.selection.ranges.forEach(l=>{const c=l.$from.pos,u=l.$to.pos;let d,p,h,b;n.selection.empty?s.doc.nodesBetween(c,u,(f,g)=>{o&&o===f.type&&(h=Math.max(g,c),b=Math.min(g+f.nodeSize,u),d=g,p=f)}):s.doc.nodesBetween(c,u,(f,g)=>{g<c&&o&&o===f.type&&(h=Math.max(g,c),b=Math.min(g+f.nodeSize,u),d=g,p=f),g>=c&&g<=u&&(o&&o===f.type&&n.setNodeMarkup(g,void 0,{...f.attrs,...t}),i&&f.marks.length&&f.marks.forEach(y=>{if(i===y.type){const v=Math.max(g,c),S=Math.min(g+f.nodeSize,u);n.addMark(v,S,i.create({...y.attrs,...t}))}}))}),p&&(d!==void 0&&n.setNodeMarkup(d,void 0,{...p.attrs,...t}),i&&p.marks.length&&p.marks.forEach(f=>{i===f.type&&n.addMark(h,b,i.create({...f.attrs,...t}))}))}),!0):!1},Gr=(e,t={})=>({state:n,dispatch:s})=>{const r=F(e,n.schema);return ts(r,t)(n,s)},Qr=(e,t={})=>({state:n,dispatch:s})=>{const r=F(e,n.schema);return Ms(r,t)(n,s)};var Jr=Object.freeze({__proto__:null,blur:_s,clearContent:Ls,clearNodes:Ns,command:Rs,createParagraphNear:Is,cut:$s,deleteCurrentNode:Ps,deleteNode:Bs,deleteRange:Hs,deleteSelection:Ds,enter:js,exitCode:Ws,extendMarkRange:zs,first:Fs,focus:qs,forEach:Us,insertContent:Vs,insertContentAt:Js,joinBackward:Zs,joinDown:Ys,joinForward:er,joinItemBackward:tr,joinItemForward:nr,joinTextblockBackward:sr,joinTextblockForward:rr,joinUp:Xs,keyboardShortcut:ir,lift:ar,liftEmptyBlock:lr,liftListItem:cr,newlineInCode:ur,resetAttributes:dr,scrollIntoView:pr,selectAll:fr,selectNodeBackward:hr,selectNodeForward:gr,selectParentNode:mr,selectTextblockEnd:yr,selectTextblockStart:br,setContent:kr,setMark:Nr,setMeta:Rr,setNode:Ir,setNodeSelection:$r,setTextSelection:Pr,sinkListItem:Br,splitBlock:Hr,splitListItem:Dr,toggleList:jr,toggleMark:Wr,toggleNode:zr,toggleWrap:Fr,undoInputRule:Kr,unsetAllMarks:qr,unsetMark:Ur,updateAttributes:Vr,wrapIn:Gr,wrapInList:Qr});D.create({name:"commands",addCommands(){return{...Jr}}});D.create({name:"drop",addProseMirrorPlugins(){return[new J({key:new Q("tiptapDrop"),props:{handleDrop:(e,t,n,s)=>{this.editor.emit("drop",{editor:this.editor,event:t,slice:n,moved:s})}}})]}});D.create({name:"editable",addProseMirrorPlugins(){return[new J({key:new Q("editable"),props:{editable:()=>this.editor.options.editable}})]}});const Xr=new Q("focusEvents");D.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:e}=this;return[new J({key:Xr,props:{handleDOMEvents:{focus:(t,n)=>{e.isFocused=!0;const s=e.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return t.dispatch(s),!1},blur:(t,n)=>{e.isFocused=!1;const s=e.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return t.dispatch(s),!1}}}})]}});D.create({name:"keymap",addKeyboardShortcuts(){const e=()=>this.editor.commands.first(({commands:i})=>[()=>i.undoInputRule(),()=>i.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:u,$anchor:d}=l,{pos:p,parent:h}=d,b=d.parent.isTextblock&&p>0?a.doc.resolve(p-1):d,f=b.parent.type.spec.isolating,g=d.pos-d.parentOffset,y=f&&b.parent.childCount===1?g===d.pos:pe.atStart(c).from===p;return!u||!h.type.isTextblock||h.textContent.length||!y||y&&d.parent.type.name==="paragraph"?!1:i.clearNodes()}),()=>i.deleteSelection(),()=>i.joinBackward(),()=>i.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:i})=>[()=>i.deleteSelection(),()=>i.deleteCurrentNode(),()=>i.joinForward(),()=>i.selectNodeForward()]),s={Enter:()=>this.editor.commands.first(({commands:i})=>[()=>i.newlineInCode(),()=>i.createParagraphNear(),()=>i.liftEmptyBlock(),()=>i.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},r={...s},o={...s,"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return je()||Zt()?o:r},addProseMirrorPlugins(){return[new J({key:new Q("clearDocument"),appendTransaction:(e,t,n)=>{if(e.some(f=>f.getMeta("composition")))return;const s=e.some(f=>f.docChanged)&&!t.doc.eq(n.doc),r=e.some(f=>f.getMeta("preventClearDocument"));if(!s||r)return;const{empty:o,from:i,to:a}=t.selection,l=pe.atStart(t.doc).from,c=pe.atEnd(t.doc).to;if(o||!(i===l&&a===c)||!it(n.doc))return;const p=n.tr,h=Gt({state:n,transaction:p}),{commands:b}=new ws({editor:this.editor,state:h});if(b.clearNodes(),!!p.steps.length)return p}})]}});D.create({name:"paste",addProseMirrorPlugins(){return[new J({key:new Q("tiptapPaste"),props:{handlePaste:(e,t,n)=>{this.editor.emit("paste",{editor:this.editor,event:t,slice:n})}}})]}});D.create({name:"tabindex",addProseMirrorPlugins(){return[new J({key:new Q("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});function Me(e){return new Ee({find:e.find,handler:({state:t,range:n,match:s})=>{const r=P(e.getAttributes,void 0,s);if(r===!1||r===null)return null;const{tr:o}=t,i=s[s.length-1],a=s[0];if(i){const l=a.search(/\S/),c=n.from+a.indexOf(i),u=c+i.length;if(ot(n.from,n.to,t.doc).filter(h=>h.mark.type.excluded.find(f=>f===e.type&&f!==h.mark.type)).filter(h=>h.to>c).length)return null;u<n.to&&o.delete(u,n.to),c>n.from&&o.delete(n.from+l,c);const p=n.from+l+i.length;o.addMark(n.from+l,p,e.type.create(r||{})),o.removeStoredMark(e.type)}}})}function Yr(e){return new Ee({find:e.find,handler:({state:t,range:n,match:s})=>{const r=P(e.getAttributes,void 0,s)||{},{tr:o}=t,i=n.from;let a=n.to;const l=e.type.create(r);if(s[1]){const c=s[0].lastIndexOf(s[1]);let u=i+c;u>a?u=a:a=u+s[1].length;const d=s[0][s[0].length-1];o.insertText(d,i+s[0].length-1),o.replaceWith(u,a,l)}else if(s[0]){const c=e.type.isInline?i:i-1;o.insert(c,e.type.create(r)).delete(o.mapping.map(i),o.mapping.map(a))}o.scrollIntoView()}})}function Je(e){return new Ee({find:e.find,handler:({state:t,range:n,match:s})=>{const r=t.doc.resolve(n.from),o=P(e.getAttributes,void 0,s)||{};if(!r.node(-1).canReplaceWith(r.index(-1),r.indexAfter(-1),e.type))return null;t.tr.delete(n.from,n.to).setBlockType(n.from,n.from,e.type,o)}})}function $(e){return new Ee({find:e.find,handler:({state:t,range:n,match:s})=>{let r=e.replace,o=n.from;const i=n.to;if(s[1]){const a=s[0].lastIndexOf(s[1]);r+=s[0].slice(a+s[1].length),o+=a;const l=o-i;l>0&&(r=s[0].slice(a-l,a)+r,o=i)}t.tr.insertText(r,o,i)}})}function we(e){return new Ee({find:e.find,handler:({state:t,range:n,match:s,chain:r})=>{const o=P(e.getAttributes,void 0,s)||{},i=t.tr.delete(n.from,n.to),l=i.doc.resolve(n.from).blockRange(),c=l&&Jn(l,e.type,o);if(!c)return null;if(i.wrap(l,c),e.keepMarks&&e.editor){const{selection:d,storedMarks:p}=t,{splittableMarks:h}=e.editor.extensionManager,b=p||d.$to.parentOffset&&d.$from.marks();if(b){const f=b.filter(g=>h.includes(g.type.name));i.ensureMarks(f)}}if(e.keepAttributes){const d=e.type.name==="bulletList"||e.type.name==="orderedList"?"listItem":"taskList";r().updateAttributes(d,o).run()}const u=i.doc.resolve(n.from-1).nodeBefore;u&&u.type===e.type&&et(i.doc,n.from-1)&&(!e.joinPredicate||e.joinPredicate(s,u))&&i.join(n.from-1)}})}class B{constructor(t={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=P(z(this,"addOptions",{name:this.name}))),this.storage=P(z(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new B(t)}configure(t={}){const n=this.extend({...this.config,addOptions:()=>De(this.options,t)});return n.name=this.name,n.parent=this.parent,n}extend(t={}){const n=new B(t);return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=P(z(n,"addOptions",{name:n.name})),n.storage=P(z(n,"addStorage",{name:n.name,options:n.options})),n}}class Zr{constructor(t,n,s){this.isDragging=!1,this.component=t,this.editor=n.editor,this.options={stopEvent:null,ignoreMutation:null,...s},this.extension=n.extension,this.node=n.node,this.decorations=n.decorations,this.innerDecorations=n.innerDecorations,this.view=n.view,this.HTMLAttributes=n.HTMLAttributes,this.getPos=n.getPos,this.mount()}mount(){}get dom(){return this.editor.view.dom}get contentDOM(){return null}onDragStart(t){var n,s,r,o,i,a,l;const{view:c}=this.editor,u=t.target,d=u.nodeType===3?(n=u.parentElement)===null||n===void 0?void 0:n.closest("[data-drag-handle]"):u.closest("[data-drag-handle]");if(!this.dom||!((s=this.contentDOM)===null||s===void 0)&&s.contains(u)||!d)return;let p=0,h=0;if(this.dom!==d){const v=this.dom.getBoundingClientRect(),S=d.getBoundingClientRect(),T=(r=t.offsetX)!==null&&r!==void 0?r:(o=t.nativeEvent)===null||o===void 0?void 0:o.offsetX,I=(i=t.offsetY)!==null&&i!==void 0?i:(a=t.nativeEvent)===null||a===void 0?void 0:a.offsetY;p=S.x-v.x+T,h=S.y-v.y+I}const b=this.dom.cloneNode(!0);(l=t.dataTransfer)===null||l===void 0||l.setDragImage(b,p,h);const f=this.getPos();if(typeof f!="number")return;const g=he.create(c.state.doc,f),y=c.state.tr.setSelection(g);c.dispatch(y)}stopEvent(t){var n;if(!this.dom)return!1;if(typeof this.options.stopEvent=="function")return this.options.stopEvent({event:t});const s=t.target;if(!(this.dom.contains(s)&&!(!((n=this.contentDOM)===null||n===void 0)&&n.contains(s))))return!1;const o=t.type.startsWith("drag"),i=t.type==="drop";if((["INPUT","BUTTON","SELECT","TEXTAREA"].includes(s.tagName)||s.isContentEditable)&&!i&&!o)return!0;const{isEditable:l}=this.editor,{isDragging:c}=this,u=!!this.node.type.spec.draggable,d=he.isSelectable(this.node),p=t.type==="copy",h=t.type==="paste",b=t.type==="cut",f=t.type==="mousedown";if(!u&&d&&o&&t.target===this.dom&&t.preventDefault(),u&&o&&!c&&t.target===this.dom)return t.preventDefault(),!1;if(u&&l&&!c&&f){const g=s.closest("[data-drag-handle]");g&&(this.dom===g||this.dom.contains(g))&&(this.isDragging=!0,document.addEventListener("dragend",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("drop",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("mouseup",()=>{this.isDragging=!1},{once:!0}))}return!(c||i||p||h||b||f&&d)}ignoreMutation(t){return!this.dom||!this.contentDOM?!0:typeof this.options.ignoreMutation=="function"?this.options.ignoreMutation({mutation:t}):this.node.isLeaf||this.node.isAtom?!0:t.type==="selection"||this.dom.contains(t.target)&&t.type==="childList"&&(je()||Xt())&&this.editor.isFocused&&[...Array.from(t.addedNodes),...Array.from(t.removedNodes)].every(s=>s.isContentEditable)?!1:this.contentDOM===t.target&&t.type==="attributes"?!0:!this.contentDOM.contains(t.target)}updateAttributes(t){this.editor.commands.command(({tr:n})=>{const s=this.getPos();return typeof s!="number"?!1:(n.setNodeMarkup(s,void 0,{...this.node.attrs,...t}),!0)})}deleteNode(){const t=this.getPos();if(typeof t!="number")return;const n=t+this.node.nodeSize;this.editor.commands.deleteRange({from:t,to:n})}}function ge(e){return new Ts({find:e.find,handler:({state:t,range:n,match:s,pasteEvent:r})=>{const o=P(e.getAttributes,void 0,s,r);if(o===!1||o===null)return null;const{tr:i}=t,a=s[s.length-1],l=s[0];let c=n.to;if(a){const u=l.search(/\S/),d=n.from+l.indexOf(a),p=d+a.length;if(ot(n.from,n.to,t.doc).filter(b=>b.mark.type.excluded.find(g=>g===e.type&&g!==b.mark.type)).filter(b=>b.to>d).length)return null;p<n.to&&i.delete(p,n.to),d>n.from&&i.delete(n.from+u,d),c=n.from+u+a.length,i.addMark(n.from+u,c,e.type.create(o||{})),i.removeStoredMark(e.type)}}})}function eo(e,t){const{selection:n}=e,{$from:s}=n;if(n instanceof he){const o=s.index();return s.parent.canReplaceWith(o,o+1,t)}let r=s.depth;for(;r>=0;){const o=s.index(r);if(s.node(r).contentMatchAt(o).matchType(t))return!0;r-=1}return!1}function to(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}const Na=Ft({name:"NodeViewWrapper",props:{as:{type:String,default:"div"}},inject:["onDragStart","decorationClasses"],render(){var e,t;return Kt(this.as,{class:this.decorationClasses,style:{whiteSpace:"normal"},"data-node-view-wrapper":"",onDragstart:this.onDragStart},(t=(e=this.$slots).default)===null||t===void 0?void 0:t.call(e))}});class no{constructor(t,{props:n={},editor:s}){this.editor=s,this.component=En(t),this.el=document.createElement("div"),this.props=Sn(n),this.renderedComponent=this.renderComponent()}get element(){return this.renderedComponent.el}get ref(){var t,n,s,r;return!((n=(t=this.renderedComponent.vNode)===null||t===void 0?void 0:t.component)===null||n===void 0)&&n.exposed?this.renderedComponent.vNode.component.exposed:(r=(s=this.renderedComponent.vNode)===null||s===void 0?void 0:s.component)===null||r===void 0?void 0:r.proxy}renderComponent(){let t=Kt(this.component,this.props);return this.editor.appContext&&(t.appContext=this.editor.appContext),typeof document!="undefined"&&this.el&&mt(t,this.el),{vNode:t,destroy:()=>{this.el&&mt(null,this.el),this.el=null,t=null},el:this.el?this.el.firstElementChild:null}}updateProps(t={}){Object.entries(t).forEach(([n,s])=>{this.props[n]=s}),this.renderComponent()}destroy(){this.renderedComponent.destroy()}}const Ra={editor:{type:Object,required:!0},node:{type:Object,required:!0},decorations:{type:Object,required:!0},selected:{type:Boolean,required:!0},extension:{type:Object,required:!0},getPos:{type:Function,required:!0},updateAttributes:{type:Function,required:!0},deleteNode:{type:Function,required:!0},view:{type:Object,required:!0},innerDecorations:{type:Object,required:!0},HTMLAttributes:{type:Object,required:!0}};class so extends Zr{mount(){const t={editor:this.editor,node:this.node,decorations:this.decorations,innerDecorations:this.innerDecorations,view:this.view,selected:!1,extension:this.extension,HTMLAttributes:this.HTMLAttributes,getPos:()=>this.getPos(),updateAttributes:(r={})=>this.updateAttributes(r),deleteNode:()=>this.deleteNode()},n=this.onDragStart.bind(this);this.decorationClasses=An(this.getDecorationClasses());const s=Ft({extends:{...this.component},props:Object.keys(t),template:this.component.template,setup:r=>{var o,i;return yt("onDragStart",n),yt("decorationClasses",this.decorationClasses),(i=(o=this.component).setup)===null||i===void 0?void 0:i.call(o,r,{expose:()=>{}})},__scopeId:this.component.__scopeId,__cssModules:this.component.__cssModules,__name:this.component.__name,__file:this.component.__file});this.handleSelectionUpdate=this.handleSelectionUpdate.bind(this),this.editor.on("selectionUpdate",this.handleSelectionUpdate),this.renderer=new no(s,{editor:this.editor,props:t})}get dom(){if(!this.renderer.element||!this.renderer.element.hasAttribute("data-node-view-wrapper"))throw Error("Please use the NodeViewWrapper component for your node view.");return this.renderer.element}get contentDOM(){return this.node.isLeaf?null:this.dom.querySelector("[data-node-view-content]")}handleSelectionUpdate(){const{from:t,to:n}=this.editor.state.selection,s=this.getPos();if(typeof s=="number")if(t<=s&&n>=s+this.node.nodeSize){if(this.renderer.props.selected)return;this.selectNode()}else{if(!this.renderer.props.selected)return;this.deselectNode()}}update(t,n,s){const r=o=>{this.decorationClasses.value=this.getDecorationClasses(),this.renderer.updateProps(o)};if(typeof this.options.update=="function"){const o=this.node,i=this.decorations,a=this.innerDecorations;return this.node=t,this.decorations=n,this.innerDecorations=s,this.options.update({oldNode:o,oldDecorations:i,newNode:t,newDecorations:n,oldInnerDecorations:a,innerDecorations:s,updateProps:()=>r({node:t,decorations:n,innerDecorations:s})})}return t.type!==this.node.type?!1:(t===this.node&&this.decorations===n&&this.innerDecorations===s||(this.node=t,this.decorations=n,this.innerDecorations=s,r({node:t,decorations:n,innerDecorations:s})),!0)}selectNode(){this.renderer.updateProps({selected:!0}),this.renderer.element&&this.renderer.element.classList.add("ProseMirror-selectednode")}deselectNode(){this.renderer.updateProps({selected:!1}),this.renderer.element&&this.renderer.element.classList.remove("ProseMirror-selectednode")}getDecorationClasses(){return this.decorations.map(t=>t.type.attrs.class).flat().join(" ")}destroy(){this.renderer.destroy(),this.editor.off("selectionUpdate",this.handleSelectionUpdate)}}function Ia(e,t){return n=>{if(!n.editor.contentComponent)return{};const s=typeof e=="function"&&"__vccOpts"in e?e.__vccOpts:e;return new so(s,n,t)}}const ro=/^\s*>\s$/,oo=B.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:e}){return["blockquote",R(this.options.HTMLAttributes,e),0]},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn(this.name),toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[we({find:ro,type:this.type})]}}),io=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,ao=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,lo=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,co=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,uo=se.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>e.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:e=>e.type.name===this.name},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML({HTMLAttributes:e}){return["strong",R(this.options.HTMLAttributes,e),0]},addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Me({find:io,type:this.type}),Me({find:lo,type:this.type})]},addPasteRules(){return[ge({find:ao,type:this.type}),ge({find:co,type:this.type})]}}),po="listItem",Ct="textStyle",Ot=/^\s*([-+*])\s$/,fo=B.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:e}){return["ul",R(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleBulletList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(po,this.editor.getAttributes(Ct)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=we({find:Ot,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=we({find:Ot,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Ct),editor:this.editor})),[e]}}),ho=/(^|[^`])`([^`]+)`(?!`)/,go=/(^|[^`])`([^`]+)`(?!`)/g,mo=se.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:e}){return["code",R(this.options.HTMLAttributes,e),0]},addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Me({find:ho,type:this.type})]},addPasteRules(){return[ge({find:go,type:this.type})]}}),yo=/^```([a-z]+)?[\s\n]$/,bo=/^~~~([a-z]+)?[\s\n]$/,nn=B.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:e=>{var t;const{languageClassPrefix:n}=this.options,o=[...((t=e.firstElementChild)===null||t===void 0?void 0:t.classList)||[]].filter(i=>i.startsWith(n)).map(i=>i.replace(n,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:e,HTMLAttributes:t}){return["pre",R(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode(this.name,e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,n=t.pos===1;return!e||t.parent.type.name!==this.name?!1:n||!t.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:t}=e,{selection:n}=t,{$from:s,empty:r}=n;if(!r||s.parent.type!==this.type)return!1;const o=s.parentOffset===s.parent.nodeSize-2,i=s.parent.textContent.endsWith(`

`);return!o||!i?!1:e.chain().command(({tr:a})=>(a.delete(s.pos-2,s.pos),!0)).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;const{state:t}=e,{selection:n,doc:s}=t,{$from:r,empty:o}=n;if(!o||r.parent.type!==this.type||!(r.parentOffset===r.parent.nodeSize-2))return!1;const a=r.after();return a===void 0?!1:s.nodeAt(a)?e.commands.command(({tr:c})=>(c.setSelection(pe.near(s.resolve(a))),!0)):e.commands.exitCode()}}},addInputRules(){return[Je({find:yo,type:this.type,getAttributes:e=>({language:e[1]})}),Je({find:bo,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new J({key:new Q("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;const n=t.clipboardData.getData("text/plain"),s=t.clipboardData.getData("vscode-editor-data"),r=s?JSON.parse(s):void 0,o=r==null?void 0:r.mode;if(!n||!o)return!1;const{tr:i,schema:a}=e.state,l=a.text(n.replace(/\r\n?/g,`
`));return i.replaceSelectionWith(this.type.create({language:o},l)),i.selection.$from.parent.type!==this.type&&i.setSelection(G.near(i.doc.resolve(Math.max(0,i.selection.from-2)))),i.setMeta("paste",!0),e.dispatch(i),!0}}})]}}),Mo=B.create({name:"doc",topNode:!0,content:"block+"}),ko=D.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[Tn(this.options)]}}),xo=D.create({name:"gapCursor",addProseMirrorPlugins(){return[Cn()]},extendNodeSchema(e){var t;const n={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:(t=P(z(e,"allowGapCursor",n)))!==null&&t!==void 0?t:null}}}),wo=B.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:e}){return["br",R(this.options.HTMLAttributes,e)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:e,chain:t,state:n,editor:s})=>e.first([()=>e.exitCode(),()=>e.command(()=>{const{selection:r,storedMarks:o}=n;if(r.$from.parent.type.spec.isolating)return!1;const{keepMarks:i}=this.options,{splittableMarks:a}=s.extensionManager,l=o||r.$to.parentOffset&&r.$from.marks();return t().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&l&&i){const d=l.filter(p=>a.includes(p.type.name));c.ensureMarks(d)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),vo=B.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:t}){return[`h${this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]}`,R(this.options.HTMLAttributes,t),0]},addCommands(){return{setHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.setNode(this.name,e):!1,toggleHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.toggleNode(this.name,"paragraph",e):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>({...e,[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>Je({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}}),Ao=D.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:e,dispatch:t})=>Ln(e,t),redo:()=>({state:e,dispatch:t})=>_n(e,t)}},addProseMirrorPlugins(){return[On(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),Eo=B.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:e}){return["hr",R(this.options.HTMLAttributes,e)]},addCommands(){return{setHorizontalRule:()=>({chain:e,state:t})=>{if(!eo(t,t.schema.nodes[this.name]))return!1;const{selection:n}=t,{$from:s,$to:r}=n,o=e();return s.parentOffset===0?o.insertContentAt({from:Math.max(s.pos-1,0),to:r.pos},{type:this.name}):_r(n)?o.insertContentAt(r.pos,{type:this.name}):o.insertContent({type:this.name}),o.command(({tr:i,dispatch:a})=>{var l;if(a){const{$to:c}=i.selection,u=c.end();if(c.nodeAfter)c.nodeAfter.isTextblock?i.setSelection(G.create(i.doc,c.pos+1)):c.nodeAfter.isBlock?i.setSelection(he.create(i.doc,c.pos)):i.setSelection(G.create(i.doc,c.pos));else{const d=(l=c.parent.type.contentMatch.defaultType)===null||l===void 0?void 0:l.create();d&&(i.insert(u,d),i.setSelection(G.create(i.doc,u+1)))}i.scrollIntoView()}return!0}).run()}}},addInputRules(){return[Yr({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),So=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,To=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,Co=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,Oo=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,_o=se.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>e.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:e=>e.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:e}){return["em",R(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Me({find:So,type:this.type}),Me({find:Co,type:this.type})]},addPasteRules(){return[ge({find:To,type:this.type}),ge({find:Oo,type:this.type})]}}),Lo=B.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",R(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),No="listItem",_t="textStyle",Lt=/^(\d+)\.\s$/,Ro=B.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1},type:{default:null,parseHTML:e=>e.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:e}){const{start:t,...n}=e;return t===1?["ol",R(this.options.HTMLAttributes,n),0]:["ol",R(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleOrderedList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(No,this.editor.getAttributes(_t)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=we({find:Lt,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,n)=>n.childCount+n.attrs.start===+t[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=we({find:Lt,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:t=>({start:+t[1],...this.editor.getAttributes(_t)}),joinPredicate:(t,n)=>n.childCount+n.attrs.start===+t[1],editor:this.editor})),[e]}}),Io=B.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:e}){return["p",R(this.options.HTMLAttributes,e),0]},addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),$o=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,Po=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,Bo=se.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["s",R(this.options.HTMLAttributes,e),0]},addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Me({find:$o,type:this.type})]},addPasteRules(){return[ge({find:Po,type:this.type})]}}),Ho=B.create({name:"text",group:"inline"});D.create({name:"starterKit",addExtensions(){const e=[];return this.options.bold!==!1&&e.push(uo.configure(this.options.bold)),this.options.blockquote!==!1&&e.push(oo.configure(this.options.blockquote)),this.options.bulletList!==!1&&e.push(fo.configure(this.options.bulletList)),this.options.code!==!1&&e.push(mo.configure(this.options.code)),this.options.codeBlock!==!1&&e.push(nn.configure(this.options.codeBlock)),this.options.document!==!1&&e.push(Mo.configure(this.options.document)),this.options.dropcursor!==!1&&e.push(ko.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&e.push(xo.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&e.push(wo.configure(this.options.hardBreak)),this.options.heading!==!1&&e.push(vo.configure(this.options.heading)),this.options.history!==!1&&e.push(Ao.configure(this.options.history)),this.options.horizontalRule!==!1&&e.push(Eo.configure(this.options.horizontalRule)),this.options.italic!==!1&&e.push(_o.configure(this.options.italic)),this.options.listItem!==!1&&e.push(Lo.configure(this.options.listItem)),this.options.orderedList!==!1&&e.push(Ro.configure(this.options.orderedList)),this.options.paragraph!==!1&&e.push(Io.configure(this.options.paragraph)),this.options.strike!==!1&&e.push(Bo.configure(this.options.strike)),this.options.text!==!1&&e.push(Ho.configure(this.options.text)),e}});D.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something …",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new J({key:new Q("placeholder"),props:{decorations:({doc:e,selection:t})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:s}=t,r=[];if(!n)return null;const o=this.editor.isEmpty;return e.descendants((i,a)=>{const l=s>=a&&s<=a+i.nodeSize,c=!i.isLeaf&&it(i);if((l||!this.options.showOnlyCurrent)&&c){const u=[this.options.emptyNodeClass];o&&u.push(this.options.emptyEditorClass);const d=Ye.node(a,a+i.nodeSize,{class:u.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:i,pos:a,hasAnchor:l}):this.options.placeholder});r.push(d)}return this.options.includeChildren}),Ze.create(e,r)}}})]}});D.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:null}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:e=>{const t=e.style.textAlign;return this.options.alignments.includes(t)?t:this.options.defaultAlignment},renderHTML:e=>e.textAlign?{style:`text-align: ${e.textAlign}`}:{}}}}]},addCommands(){return{setTextAlign:e=>({commands:t})=>this.options.alignments.includes(e)?this.options.types.map(n=>t.updateAttributes(n,{textAlign:e})).every(n=>n):!1,unsetTextAlign:()=>({commands:e})=>this.options.types.map(t=>e.resetAttributes(t,"textAlign")).every(t=>t),toggleTextAlign:e=>({editor:t,commands:n})=>this.options.alignments.includes(e)?t.isActive({textAlign:e})?n.unsetTextAlign():n.setTextAlign(e):!1}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}});function Xe(e,t){return t?["width",`${Math.max(t,e)}px`]:["min-width",`${e}px`]}function Nt(e,t,n,s,r,o){var i;let a=0,l=!0,c=t.firstChild;const u=e.firstChild;if(u!==null)for(let d=0,p=0;d<u.childCount;d+=1){const{colspan:h,colwidth:b}=u.child(d).attrs;for(let f=0;f<h;f+=1,p+=1){const g=r===p?o:b&&b[f],y=g?`${g}px`:"";if(a+=g||s,g||(l=!1),c){if(c.style.width!==y){const[v,S]=Xe(s,g);c.style.setProperty(v,S)}c=c.nextSibling}else{const v=document.createElement("col"),[S,T]=Xe(s,g);v.style.setProperty(S,T),t.appendChild(v)}}}for(;c;){const d=c.nextSibling;(i=c.parentNode)===null||i===void 0||i.removeChild(c),c=d}l?(n.style.width=`${a}px`,n.style.minWidth=""):(n.style.width="",n.style.minWidth=`${a}px`)}class Do{constructor(t,n){this.node=t,this.cellMinWidth=n,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),Nt(t,this.colgroup,this.table,n),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(t){return t.type!==this.node.type?!1:(this.node=t,Nt(t,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(t){return t.type==="attributes"&&(t.target===this.table||this.colgroup.contains(t.target))}}function jo(e,t,n,s){let r=0,o=!0;const i=[],a=e.firstChild;if(!a)return{};for(let d=0,p=0;d<a.childCount;d+=1){const{colspan:h,colwidth:b}=a.child(d).attrs;for(let f=0;f<h;f+=1,p+=1){const g=n===p?s:b&&b[f];r+=g||t,g||(o=!1);const[y,v]=Xe(t,g);i.push(["col",{style:`${y}: ${v}`}])}}const l=o?`${r}px`:"",c=o?"":`${r}px`;return{colgroup:["colgroup",{},...i],tableWidth:l,tableMinWidth:c}}function Rt(e,t){return e.createAndFill()}function Wo(e){if(e.cached.tableNodeTypes)return e.cached.tableNodeTypes;const t={};return Object.keys(e.nodes).forEach(n=>{const s=e.nodes[n];s.spec.tableRole&&(t[s.spec.tableRole]=s)}),e.cached.tableNodeTypes=t,t}function zo(e,t,n,s,r){const o=Wo(e),i=[],a=[];for(let c=0;c<n;c+=1){const u=Rt(o.cell);if(u&&a.push(u),s){const d=Rt(o.header_cell);d&&i.push(d)}}const l=[];for(let c=0;c<t;c+=1)l.push(o.row.createChecked(null,s&&c===0?i:a));return o.table.createChecked(null,l)}function Fo(e){return e instanceof qt}const Re=({editor:e})=>{const{selection:t}=e.state;if(!Fo(t))return!1;let n=0;const s=tn(t.ranges[0].$from,o=>o.type.name==="table");return s==null||s.node.descendants(o=>{if(o.type.name==="table")return!1;["tableCell","tableHeader"].includes(o.type.name)&&(n+=1)}),n===t.ranges.length?(e.commands.deleteTable(),!0):!1};B.create({name:"table",addOptions(){return{HTMLAttributes:{},resizable:!1,handleWidth:5,cellMinWidth:25,View:Do,lastColumnResizable:!0,allowTableNodeSelection:!1}},content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML(){return[{tag:"table"}]},renderHTML({node:e,HTMLAttributes:t}){const{colgroup:n,tableWidth:s,tableMinWidth:r}=jo(e,this.options.cellMinWidth);return["table",R(this.options.HTMLAttributes,t,{style:s?`width: ${s}`:`min-width: ${r}`}),n,["tbody",0]]},addCommands(){return{insertTable:({rows:e=3,cols:t=3,withHeaderRow:n=!0}={})=>({tr:s,dispatch:r,editor:o})=>{const i=zo(o.schema,e,t,n);if(r){const a=s.selection.from+1;s.replaceSelectionWith(i).scrollIntoView().setSelection(G.near(s.doc.resolve(a)))}return!0},addColumnBefore:()=>({state:e,dispatch:t})=>Kn(e,t),addColumnAfter:()=>({state:e,dispatch:t})=>Fn(e,t),deleteColumn:()=>({state:e,dispatch:t})=>zn(e,t),addRowBefore:()=>({state:e,dispatch:t})=>Wn(e,t),addRowAfter:()=>({state:e,dispatch:t})=>jn(e,t),deleteRow:()=>({state:e,dispatch:t})=>Dn(e,t),deleteTable:()=>({state:e,dispatch:t})=>Hn(e,t),mergeCells:()=>({state:e,dispatch:t})=>Mt(e,t),splitCell:()=>({state:e,dispatch:t})=>kt(e,t),toggleHeaderColumn:()=>({state:e,dispatch:t})=>xt("column")(e,t),toggleHeaderRow:()=>({state:e,dispatch:t})=>xt("row")(e,t),toggleHeaderCell:()=>({state:e,dispatch:t})=>Bn(e,t),mergeOrSplit:()=>({state:e,dispatch:t})=>Mt(e,t)?!0:kt(e,t),setCellAttribute:(e,t)=>({state:n,dispatch:s})=>Pn(e,t)(n,s),goToNextCell:()=>({state:e,dispatch:t})=>bt(1)(e,t),goToPreviousCell:()=>({state:e,dispatch:t})=>bt(-1)(e,t),fixTables:()=>({state:e,dispatch:t})=>(t&&$n(e),!0),setCellSelection:e=>({tr:t,dispatch:n})=>{if(n){const s=qt.create(t.doc,e.anchorCell,e.headCell);t.setSelection(s)}return!0}}},addKeyboardShortcuts(){return{Tab:()=>this.editor.commands.goToNextCell()?!0:this.editor.can().addRowAfter()?this.editor.chain().addRowAfter().goToNextCell().run():!1,"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:Re,"Mod-Backspace":Re,Delete:Re,"Mod-Delete":Re}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[Rn({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,defaultCellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],In({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema(e){const t={name:e.name,options:e.options,storage:e.storage};return{tableRole:P(z(e,"tableRole",t))}}});B.create({name:"tableCell",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:e=>{const t=e.getAttribute("colwidth");return t?t.split(",").map(s=>parseInt(s,10)):null}}}},tableRole:"cell",isolating:!0,parseHTML(){return[{tag:"td"}]},renderHTML({HTMLAttributes:e}){return["td",R(this.options.HTMLAttributes,e),0]}});B.create({name:"tableHeader",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:e=>{const t=e.getAttribute("colwidth");return t?t.split(",").map(s=>parseInt(s,10)):null}}}},tableRole:"header_cell",isolating:!0,parseHTML(){return[{tag:"th"}]},renderHTML({HTMLAttributes:e}){return["th",R(this.options.HTMLAttributes,e),0]}});B.create({name:"tableRow",addOptions(){return{HTMLAttributes:{}}},content:"(tableCell | tableHeader)*",tableRole:"row",parseHTML(){return[{tag:"tr"}]},renderHTML({HTMLAttributes:e}){return["tr",R(this.options.HTMLAttributes,e),0]}});function Ko(e){return e.length===1?e[0].isLink:e.length===3&&e[1].isLink?["()","[]"].includes(e[0].value+e[2].value):!1}function qo(e){return new J({key:new Q("autolink"),appendTransaction:(t,n,s)=>{const r=t.some(c=>c.docChanged)&&!n.doc.eq(s.doc),o=t.some(c=>c.getMeta("preventAutolink"));if(!r||o)return;const{tr:i}=s,a=xr(n.doc,[...t]);if(Cr(a).forEach(({newRange:c})=>{const u=vr(s.doc,c,h=>h.isTextblock);let d,p;if(u.length>1?(d=u[0],p=s.doc.textBetween(d.pos,d.pos+d.node.nodeSize,void 0," ")):u.length&&s.doc.textBetween(c.from,c.to," "," ").endsWith(" ")&&(d=u[0],p=s.doc.textBetween(d.pos,c.to,void 0," ")),d&&p){const h=p.split(" ").filter(y=>y!=="");if(h.length<=0)return!1;const b=h[h.length-1],f=d.pos+p.lastIndexOf(b);if(!b)return!1;const g=qn(b).map(y=>y.toObject(e.defaultProtocol));if(!Ko(g))return!1;g.filter(y=>y.isLink).map(y=>({...y,from:f+y.start+1,to:f+y.end+1})).filter(y=>s.schema.marks.code?!s.doc.rangeHasMark(y.from,y.to,s.schema.marks.code):!0).filter(y=>e.validate(y.value)).filter(y=>e.shouldAutoLink(y.value)).forEach(y=>{ot(y.from,y.to,s.doc).some(v=>v.mark.type===e.type)||i.addMark(y.from,y.to,e.type.create({href:y.href}))})}}),!!i.steps.length)return i}})}function Uo(e){return new J({key:new Q("handleClickLink"),props:{handleClick:(t,n,s)=>{var r,o;if(s.button!==0||!t.editable)return!1;let i=s.target;const a=[];for(;i.nodeName!=="DIV";)a.push(i),i=i.parentNode;if(!a.find(p=>p.nodeName==="A"))return!1;const l=Er(t.state,e.type.name),c=s.target,u=(r=c==null?void 0:c.href)!==null&&r!==void 0?r:l.href,d=(o=c==null?void 0:c.target)!==null&&o!==void 0?o:l.target;return c&&u?(window.open(u,d),!0):!1}}})}function Vo(e){return new J({key:new Q("handlePasteLink"),props:{handlePaste:(t,n,s)=>{const{state:r}=t,{selection:o}=r,{empty:i}=o;if(i)return!1;let a="";s.content.forEach(c=>{a+=c.textContent});const l=Ut(a,{defaultProtocol:e.defaultProtocol}).find(c=>c.isLink&&c.value===a);return!a||!l?!1:e.editor.commands.setMark(e.type,{href:l.href})}}})}const Go=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g;function ue(e,t){const n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return t&&t.forEach(s=>{const r=typeof s=="string"?s:s.scheme;r&&n.push(r)}),!e||e.replace(Go,"").match(new RegExp(`^(?:(?:${n.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}const $a=se.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(e=>{if(typeof e=="string"){wt(e);return}wt(e.scheme,e.optionalSlashes)})},onDestroy(){Un()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(e,t)=>!!ue(e,t.protocols),validate:e=>!!e,shouldAutoLink:e=>!!e}},addAttributes(){return{href:{default:null,parseHTML(e){return e.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:e=>{const t=e.getAttribute("href");return!t||!this.options.isAllowedUri(t,{defaultValidate:n=>!!ue(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:e}){return this.options.isAllowedUri(e.href,{defaultValidate:t=>!!ue(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",R(this.options.HTMLAttributes,e),0]:["a",R(this.options.HTMLAttributes,{...e,href:""}),0]},addCommands(){return{setLink:e=>({chain:t})=>{const{href:n}=e;return this.options.isAllowedUri(n,{defaultValidate:s=>!!ue(s,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?t().setMark(this.name,e).setMeta("preventAutolink",!0).run():!1},toggleLink:e=>({chain:t})=>{const{href:n}=e;return this.options.isAllowedUri(n,{defaultValidate:s=>!!ue(s,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?t().toggleMark(this.name,e,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run():!1},unsetLink:()=>({chain:e})=>e().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[ge({find:e=>{const t=[];if(e){const{protocols:n,defaultProtocol:s}=this.options,r=Ut(e).filter(o=>o.isLink&&this.options.isAllowedUri(o.value,{defaultValidate:i=>!!ue(i,n),protocols:n,defaultProtocol:s}));r.length&&r.forEach(o=>t.push({text:o.value,data:{href:o.href},index:o.start}))}return t},type:this.type,getAttributes:e=>{var t;return{href:(t=e.data)===null||t===void 0?void 0:t.href}}})]},addProseMirrorPlugins(){const e=[],{protocols:t,defaultProtocol:n}=this.options;return this.options.autolink&&e.push(qo({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:s=>this.options.isAllowedUri(s,{defaultValidate:r=>!!ue(r,t),protocols:t,defaultProtocol:n}),shouldAutoLink:this.options.shouldAutoLink})),this.options.openOnClick===!0&&e.push(Uo({type:this.type})),this.options.linkOnPaste&&e.push(Vo({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type})),e}}),Qo=e=>$({find:/--$/,replace:e!=null?e:"—"}),Jo=e=>$({find:/\.\.\.$/,replace:e!=null?e:"…"}),Xo=e=>$({find:/(?:^|[\s{[(<'"\u2018\u201C])(")$/,replace:e!=null?e:"“"}),Yo=e=>$({find:/"$/,replace:e!=null?e:"”"}),Zo=e=>$({find:/(?:^|[\s{[(<'"\u2018\u201C])(')$/,replace:e!=null?e:"‘"}),ei=e=>$({find:/'$/,replace:e!=null?e:"’"}),ti=e=>$({find:/<-$/,replace:e!=null?e:"←"}),ni=e=>$({find:/->$/,replace:e!=null?e:"→"}),si=e=>$({find:/\(c\)$/,replace:e!=null?e:"©"}),ri=e=>$({find:/\(tm\)$/,replace:e!=null?e:"™"}),oi=e=>$({find:/\(sm\)$/,replace:e!=null?e:"℠"}),ii=e=>$({find:/\(r\)$/,replace:e!=null?e:"®"}),ai=e=>$({find:/(?:^|\s)(1\/2)\s$/,replace:e!=null?e:"½"}),li=e=>$({find:/\+\/-$/,replace:e!=null?e:"±"}),ci=e=>$({find:/!=$/,replace:e!=null?e:"≠"}),ui=e=>$({find:/<<$/,replace:e!=null?e:"«"}),di=e=>$({find:/>>$/,replace:e!=null?e:"»"}),pi=e=>$({find:/\d+\s?([*x])\s?\d+$/,replace:e!=null?e:"×"}),fi=e=>$({find:/\^2$/,replace:e!=null?e:"²"}),hi=e=>$({find:/\^3$/,replace:e!=null?e:"³"}),gi=e=>$({find:/(?:^|\s)(1\/4)\s$/,replace:e!=null?e:"¼"}),mi=e=>$({find:/(?:^|\s)(3\/4)\s$/,replace:e!=null?e:"¾"});D.create({name:"typography",addOptions(){return{closeDoubleQuote:"”",closeSingleQuote:"’",copyright:"©",ellipsis:"…",emDash:"—",laquo:"«",leftArrow:"←",multiplication:"×",notEqual:"≠",oneHalf:"½",oneQuarter:"¼",openDoubleQuote:"“",openSingleQuote:"‘",plusMinus:"±",raquo:"»",registeredTrademark:"®",rightArrow:"→",servicemark:"℠",superscriptThree:"³",superscriptTwo:"²",threeQuarters:"¾",trademark:"™"}},addInputRules(){const e=[];return this.options.emDash!==!1&&e.push(Qo(this.options.emDash)),this.options.ellipsis!==!1&&e.push(Jo(this.options.ellipsis)),this.options.openDoubleQuote!==!1&&e.push(Xo(this.options.openDoubleQuote)),this.options.closeDoubleQuote!==!1&&e.push(Yo(this.options.closeDoubleQuote)),this.options.openSingleQuote!==!1&&e.push(Zo(this.options.openSingleQuote)),this.options.closeSingleQuote!==!1&&e.push(ei(this.options.closeSingleQuote)),this.options.leftArrow!==!1&&e.push(ti(this.options.leftArrow)),this.options.rightArrow!==!1&&e.push(ni(this.options.rightArrow)),this.options.copyright!==!1&&e.push(si(this.options.copyright)),this.options.trademark!==!1&&e.push(ri(this.options.trademark)),this.options.servicemark!==!1&&e.push(oi(this.options.servicemark)),this.options.registeredTrademark!==!1&&e.push(ii(this.options.registeredTrademark)),this.options.oneHalf!==!1&&e.push(ai(this.options.oneHalf)),this.options.plusMinus!==!1&&e.push(li(this.options.plusMinus)),this.options.notEqual!==!1&&e.push(ci(this.options.notEqual)),this.options.laquo!==!1&&e.push(ui(this.options.laquo)),this.options.raquo!==!1&&e.push(di(this.options.raquo)),this.options.multiplication!==!1&&e.push(pi(this.options.multiplication)),this.options.superscriptTwo!==!1&&e.push(fi(this.options.superscriptTwo)),this.options.superscriptThree!==!1&&e.push(hi(this.options.superscriptThree)),this.options.oneQuarter!==!1&&e.push(gi(this.options.oneQuarter)),this.options.threeQuarters!==!1&&e.push(mi(this.options.threeQuarters)),e}});const yi=e=>{if(!e.children.length)return;const t=e.querySelectorAll("span");t&&t.forEach(n=>{var s,r;const o=n.getAttribute("style"),i=(r=(s=n.parentElement)===null||s===void 0?void 0:s.closest("span"))===null||r===void 0?void 0:r.getAttribute("style");n.setAttribute("style",`${i};${o}`)})};se.create({name:"textStyle",priority:101,addOptions(){return{HTMLAttributes:{},mergeNestedSpanStyles:!1}},parseHTML(){return[{tag:"span",getAttrs:e=>e.hasAttribute("style")?(this.options.mergeNestedSpanStyles&&yi(e),{}):!1}]},renderHTML({HTMLAttributes:e}){return["span",R(this.options.HTMLAttributes,e),0]},addCommands(){return{removeEmptyTextStyle:()=>({tr:e})=>{const{selection:t}=e;return e.doc.nodesBetween(t.from,t.to,(n,s)=>{if(n.isTextblock)return!0;n.marks.filter(r=>r.type===this.type).some(r=>Object.values(r.attrs).some(o=>!!o))||e.removeMark(s,s+n.nodeSize,this.type)}),!0}}}});function bi(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function sn(e){return e instanceof Map?e.clear=e.delete=e.set=function(){throw new Error("map is read-only")}:e instanceof Set&&(e.add=e.clear=e.delete=function(){throw new Error("set is read-only")}),Object.freeze(e),Object.getOwnPropertyNames(e).forEach(t=>{const n=e[t],s=typeof n;(s==="object"||s==="function")&&!Object.isFrozen(n)&&sn(n)}),e}class It{constructor(t){t.data===void 0&&(t.data={}),this.data=t.data,this.isMatchIgnored=!1}ignoreMatch(){this.isMatchIgnored=!0}}function rn(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}function oe(e,...t){const n=Object.create(null);for(const s in e)n[s]=e[s];return t.forEach(function(s){for(const r in s)n[r]=s[r]}),n}const Mi="</span>",$t=e=>!!e.scope,ki=(e,{prefix:t})=>{if(e.startsWith("language:"))return e.replace("language:","language-");if(e.includes(".")){const n=e.split(".");return[`${t}${n.shift()}`,...n.map((s,r)=>`${s}${"_".repeat(r+1)}`)].join(" ")}return`${t}${e}`};class xi{constructor(t,n){this.buffer="",this.classPrefix=n.classPrefix,t.walk(this)}addText(t){this.buffer+=rn(t)}openNode(t){if(!$t(t))return;const n=ki(t.scope,{prefix:this.classPrefix});this.span(n)}closeNode(t){$t(t)&&(this.buffer+=Mi)}value(){return this.buffer}span(t){this.buffer+=`<span class="${t}">`}}const Pt=(e={})=>{const t={children:[]};return Object.assign(t,e),t};class at{constructor(){this.rootNode=Pt(),this.stack=[this.rootNode]}get top(){return this.stack[this.stack.length-1]}get root(){return this.rootNode}add(t){this.top.children.push(t)}openNode(t){const n=Pt({scope:t});this.add(n),this.stack.push(n)}closeNode(){if(this.stack.length>1)return this.stack.pop()}closeAllNodes(){for(;this.closeNode(););}toJSON(){return JSON.stringify(this.rootNode,null,4)}walk(t){return this.constructor._walk(t,this.rootNode)}static _walk(t,n){return typeof n=="string"?t.addText(n):n.children&&(t.openNode(n),n.children.forEach(s=>this._walk(t,s)),t.closeNode(n)),t}static _collapse(t){typeof t!="string"&&t.children&&(t.children.every(n=>typeof n=="string")?t.children=[t.children.join("")]:t.children.forEach(n=>{at._collapse(n)}))}}class wi extends at{constructor(t){super(),this.options=t}addText(t){t!==""&&this.add(t)}startScope(t){this.openNode(t)}endScope(){this.closeNode()}__addSublanguage(t,n){const s=t.root;n&&(s.scope=`language:${n}`),this.add(s)}toHTML(){return new xi(this,this.options).value()}finalize(){return this.closeAllNodes(),!0}}function ve(e){return e?typeof e=="string"?e:e.source:null}function on(e){return me("(?=",e,")")}function vi(e){return me("(?:",e,")*")}function Ai(e){return me("(?:",e,")?")}function me(...e){return e.map(n=>ve(n)).join("")}function Ei(e){const t=e[e.length-1];return typeof t=="object"&&t.constructor===Object?(e.splice(e.length-1,1),t):{}}function lt(...e){return"("+(Ei(e).capture?"":"?:")+e.map(s=>ve(s)).join("|")+")"}function an(e){return new RegExp(e.toString()+"|").exec("").length-1}function Si(e,t){const n=e&&e.exec(t);return n&&n.index===0}const Ti=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9][0-9]*)|\\./;function ct(e,{joinWith:t}){let n=0;return e.map(s=>{n+=1;const r=n;let o=ve(s),i="";for(;o.length>0;){const a=Ti.exec(o);if(!a){i+=o;break}i+=o.substring(0,a.index),o=o.substring(a.index+a[0].length),a[0][0]==="\\"&&a[1]?i+="\\"+String(Number(a[1])+r):(i+=a[0],a[0]==="("&&n++)}return i}).map(s=>`(${s})`).join(t)}const Ci=/\b\B/,ln="[a-zA-Z]\\w*",ut="[a-zA-Z_]\\w*",cn="\\b\\d+(\\.\\d+)?",un="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",dn="\\b(0b[01]+)",Oi="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",_i=(e={})=>{const t=/^#![ ]*\//;return e.binary&&(e.begin=me(t,/.*\b/,e.binary,/\b.*/)),oe({scope:"meta",begin:t,end:/$/,relevance:0,"on:begin":(n,s)=>{n.index!==0&&s.ignoreMatch()}},e)},Ae={begin:"\\\\[\\s\\S]",relevance:0},Li={scope:"string",begin:"'",end:"'",illegal:"\\n",contains:[Ae]},Ni={scope:"string",begin:'"',end:'"',illegal:"\\n",contains:[Ae]},Ri={begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},We=function(e,t,n={}){const s=oe({scope:"comment",begin:e,end:t,contains:[]},n);s.contains.push({scope:"doctag",begin:"[ ]*(?=(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):)",end:/(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):/,excludeBegin:!0,relevance:0});const r=lt("I","a","is","so","us","to","at","if","in","it","on",/[A-Za-z]+['](d|ve|re|ll|t|s|n)/,/[A-Za-z]+[-][a-z]+/,/[A-Za-z][a-z]{2,}/);return s.contains.push({begin:me(/[ ]+/,"(",r,/[.]?[:]?([.][ ]|[ ])/,"){3}")}),s},Ii=We("//","$"),$i=We("/\\*","\\*/"),Pi=We("#","$"),Bi={scope:"number",begin:cn,relevance:0},Hi={scope:"number",begin:un,relevance:0},Di={scope:"number",begin:dn,relevance:0},ji={scope:"regexp",begin:/\/(?=[^/\n]*\/)/,end:/\/[gimuy]*/,contains:[Ae,{begin:/\[/,end:/\]/,relevance:0,contains:[Ae]}]},Wi={scope:"title",begin:ln,relevance:0},zi={scope:"title",begin:ut,relevance:0},Fi={begin:"\\.\\s*"+ut,relevance:0},Ki=function(e){return Object.assign(e,{"on:begin":(t,n)=>{n.data._beginMatch=t[1]},"on:end":(t,n)=>{n.data._beginMatch!==t[1]&&n.ignoreMatch()}})};var Ie=Object.freeze({__proto__:null,APOS_STRING_MODE:Li,BACKSLASH_ESCAPE:Ae,BINARY_NUMBER_MODE:Di,BINARY_NUMBER_RE:dn,COMMENT:We,C_BLOCK_COMMENT_MODE:$i,C_LINE_COMMENT_MODE:Ii,C_NUMBER_MODE:Hi,C_NUMBER_RE:un,END_SAME_AS_BEGIN:Ki,HASH_COMMENT_MODE:Pi,IDENT_RE:ln,MATCH_NOTHING_RE:Ci,METHOD_GUARD:Fi,NUMBER_MODE:Bi,NUMBER_RE:cn,PHRASAL_WORDS_MODE:Ri,QUOTE_STRING_MODE:Ni,REGEXP_MODE:ji,RE_STARTERS_RE:Oi,SHEBANG:_i,TITLE_MODE:Wi,UNDERSCORE_IDENT_RE:ut,UNDERSCORE_TITLE_MODE:zi});function qi(e,t){e.input[e.index-1]==="."&&t.ignoreMatch()}function Ui(e,t){e.className!==void 0&&(e.scope=e.className,delete e.className)}function Vi(e,t){t&&e.beginKeywords&&(e.begin="\\b("+e.beginKeywords.split(" ").join("|")+")(?!\\.)(?=\\b|\\s)",e.__beforeBegin=qi,e.keywords=e.keywords||e.beginKeywords,delete e.beginKeywords,e.relevance===void 0&&(e.relevance=0))}function Gi(e,t){Array.isArray(e.illegal)&&(e.illegal=lt(...e.illegal))}function Qi(e,t){if(e.match){if(e.begin||e.end)throw new Error("begin & end are not supported with match");e.begin=e.match,delete e.match}}function Ji(e,t){e.relevance===void 0&&(e.relevance=1)}const Xi=(e,t)=>{if(!e.beforeMatch)return;if(e.starts)throw new Error("beforeMatch cannot be used with starts");const n=Object.assign({},e);Object.keys(e).forEach(s=>{delete e[s]}),e.keywords=n.keywords,e.begin=me(n.beforeMatch,on(n.begin)),e.starts={relevance:0,contains:[Object.assign(n,{endsParent:!0})]},e.relevance=0,delete n.beforeMatch},Yi=["of","and","for","in","not","or","if","then","parent","list","value"],Zi="keyword";function pn(e,t,n=Zi){const s=Object.create(null);return typeof e=="string"?r(n,e.split(" ")):Array.isArray(e)?r(n,e):Object.keys(e).forEach(function(o){Object.assign(s,pn(e[o],t,o))}),s;function r(o,i){t&&(i=i.map(a=>a.toLowerCase())),i.forEach(function(a){const l=a.split("|");s[l[0]]=[o,ea(l[0],l[1])]})}}function ea(e,t){return t?Number(t):ta(e)?0:1}function ta(e){return Yi.includes(e.toLowerCase())}const Bt={},fe=e=>{console.error(e)},Ht=(e,...t)=>{console.log(`WARN: ${e}`,...t)},ye=(e,t)=>{Bt[`${e}/${t}`]||(console.log(`Deprecated as of ${e}. ${t}`),Bt[`${e}/${t}`]=!0)},He=new Error;function fn(e,t,{key:n}){let s=0;const r=e[n],o={},i={};for(let a=1;a<=t.length;a++)i[a+s]=r[a],o[a+s]=!0,s+=an(t[a-1]);e[n]=i,e[n]._emit=o,e[n]._multi=!0}function na(e){if(Array.isArray(e.begin)){if(e.skip||e.excludeBegin||e.returnBegin)throw fe("skip, excludeBegin, returnBegin not compatible with beginScope: {}"),He;if(typeof e.beginScope!="object"||e.beginScope===null)throw fe("beginScope must be object"),He;fn(e,e.begin,{key:"beginScope"}),e.begin=ct(e.begin,{joinWith:""})}}function sa(e){if(Array.isArray(e.end)){if(e.skip||e.excludeEnd||e.returnEnd)throw fe("skip, excludeEnd, returnEnd not compatible with endScope: {}"),He;if(typeof e.endScope!="object"||e.endScope===null)throw fe("endScope must be object"),He;fn(e,e.end,{key:"endScope"}),e.end=ct(e.end,{joinWith:""})}}function ra(e){e.scope&&typeof e.scope=="object"&&e.scope!==null&&(e.beginScope=e.scope,delete e.scope)}function oa(e){ra(e),typeof e.beginScope=="string"&&(e.beginScope={_wrap:e.beginScope}),typeof e.endScope=="string"&&(e.endScope={_wrap:e.endScope}),na(e),sa(e)}function ia(e){function t(i,a){return new RegExp(ve(i),"m"+(e.case_insensitive?"i":"")+(e.unicodeRegex?"u":"")+(a?"g":""))}class n{constructor(){this.matchIndexes={},this.regexes=[],this.matchAt=1,this.position=0}addRule(a,l){l.position=this.position++,this.matchIndexes[this.matchAt]=l,this.regexes.push([l,a]),this.matchAt+=an(a)+1}compile(){this.regexes.length===0&&(this.exec=()=>null);const a=this.regexes.map(l=>l[1]);this.matcherRe=t(ct(a,{joinWith:"|"}),!0),this.lastIndex=0}exec(a){this.matcherRe.lastIndex=this.lastIndex;const l=this.matcherRe.exec(a);if(!l)return null;const c=l.findIndex((d,p)=>p>0&&d!==void 0),u=this.matchIndexes[c];return l.splice(0,c),Object.assign(l,u)}}class s{constructor(){this.rules=[],this.multiRegexes=[],this.count=0,this.lastIndex=0,this.regexIndex=0}getMatcher(a){if(this.multiRegexes[a])return this.multiRegexes[a];const l=new n;return this.rules.slice(a).forEach(([c,u])=>l.addRule(c,u)),l.compile(),this.multiRegexes[a]=l,l}resumingScanAtSamePosition(){return this.regexIndex!==0}considerAll(){this.regexIndex=0}addRule(a,l){this.rules.push([a,l]),l.type==="begin"&&this.count++}exec(a){const l=this.getMatcher(this.regexIndex);l.lastIndex=this.lastIndex;let c=l.exec(a);if(this.resumingScanAtSamePosition()&&!(c&&c.index===this.lastIndex)){const u=this.getMatcher(0);u.lastIndex=this.lastIndex+1,c=u.exec(a)}return c&&(this.regexIndex+=c.position+1,this.regexIndex===this.count&&this.considerAll()),c}}function r(i){const a=new s;return i.contains.forEach(l=>a.addRule(l.begin,{rule:l,type:"begin"})),i.terminatorEnd&&a.addRule(i.terminatorEnd,{type:"end"}),i.illegal&&a.addRule(i.illegal,{type:"illegal"}),a}function o(i,a){const l=i;if(i.isCompiled)return l;[Ui,Qi,oa,Xi].forEach(u=>u(i,a)),e.compilerExtensions.forEach(u=>u(i,a)),i.__beforeBegin=null,[Vi,Gi,Ji].forEach(u=>u(i,a)),i.isCompiled=!0;let c=null;return typeof i.keywords=="object"&&i.keywords.$pattern&&(i.keywords=Object.assign({},i.keywords),c=i.keywords.$pattern,delete i.keywords.$pattern),c=c||/\w+/,i.keywords&&(i.keywords=pn(i.keywords,e.case_insensitive)),l.keywordPatternRe=t(c,!0),a&&(i.begin||(i.begin=/\B|\b/),l.beginRe=t(l.begin),!i.end&&!i.endsWithParent&&(i.end=/\B|\b/),i.end&&(l.endRe=t(l.end)),l.terminatorEnd=ve(l.end)||"",i.endsWithParent&&a.terminatorEnd&&(l.terminatorEnd+=(i.end?"|":"")+a.terminatorEnd)),i.illegal&&(l.illegalRe=t(i.illegal)),i.contains||(i.contains=[]),i.contains=[].concat(...i.contains.map(function(u){return aa(u==="self"?i:u)})),i.contains.forEach(function(u){o(u,l)}),i.starts&&o(i.starts,a),l.matcher=r(l),l}if(e.compilerExtensions||(e.compilerExtensions=[]),e.contains&&e.contains.includes("self"))throw new Error("ERR: contains `self` is not supported at the top-level of a language.  See documentation.");return e.classNameAliases=oe(e.classNameAliases||{}),o(e)}function hn(e){return e?e.endsWithParent||hn(e.starts):!1}function aa(e){return e.variants&&!e.cachedVariants&&(e.cachedVariants=e.variants.map(function(t){return oe(e,{variants:null},t)})),e.cachedVariants?e.cachedVariants:hn(e)?oe(e,{starts:e.starts?oe(e.starts):null}):Object.isFrozen(e)?oe(e):e}var la="11.10.0";class ca extends Error{constructor(t,n){super(t),this.name="HTMLInjectionError",this.html=n}}const Ge=rn,Dt=oe,jt=Symbol("nomatch"),ua=7,gn=function(e){const t=Object.create(null),n=Object.create(null),s=[];let r=!0;const o="Could not find the language '{}', did you forget to load/include a language module?",i={disableAutodetect:!0,name:"Plain text",contains:[]};let a={ignoreUnescapedHTML:!1,throwUnescapedHTML:!1,noHighlightRe:/^(no-?highlight)$/i,languageDetectRe:/\blang(?:uage)?-([\w-]+)\b/i,classPrefix:"hljs-",cssSelector:"pre code",languages:null,__emitter:wi};function l(m){return a.noHighlightRe.test(m)}function c(m){let k=m.className+" ";k+=m.parentNode?m.parentNode.className:"";const A=a.languageDetectRe.exec(k);if(A){const C=j(A[1]);return C||(Ht(o.replace("{}",A[1])),Ht("Falling back to no-highlight mode for this block.",m)),C?A[1]:"no-highlight"}return k.split(/\s+/).find(C=>l(C)||j(C))}function u(m,k,A){let C="",L="";typeof k=="object"?(C=m,A=k.ignoreIllegals,L=k.language):(ye("10.7.0","highlight(lang, code, ...args) has been deprecated."),ye("10.7.0",`Please use highlight(code, options) instead.
https://github.com/highlightjs/highlight.js/issues/2277`),L=m,C=k),A===void 0&&(A=!0);const X={code:C,language:L};re("before:highlight",X);const Z=X.result?X.result:d(X.language,X.code,A);return Z.code=X.code,re("after:highlight",Z),Z}function d(m,k,A,C){const L=Object.create(null);function X(M,x){return M.keywords[x]}function Z(){if(!w.keywords){W.addText(N);return}let M=0;w.keywordPatternRe.lastIndex=0;let x=w.keywordPatternRe.exec(N),E="";for(;x;){E+=N.substring(M,x.index);const O=te.case_insensitive?x[0].toLowerCase():x[0],q=X(w,O);if(q){const[ne,wn]=q;if(W.addText(E),E="",L[O]=(L[O]||0)+1,L[O]<=ua&&(_e+=wn),ne.startsWith("_"))E+=x[0];else{const vn=te.classNameAliases[ne]||ne;ee(x[0],vn)}}else E+=x[0];M=w.keywordPatternRe.lastIndex,x=w.keywordPatternRe.exec(N)}E+=N.substring(M),W.addText(E)}function Ce(){if(N==="")return;let M=null;if(typeof w.subLanguage=="string"){if(!t[w.subLanguage]){W.addText(N);return}M=d(w.subLanguage,N,!0,gt[w.subLanguage]),gt[w.subLanguage]=M._top}else M=h(N,w.subLanguage.length?w.subLanguage:null);w.relevance>0&&(_e+=M.relevance),W.__addSublanguage(M._emitter,M.language)}function Y(){w.subLanguage!=null?Ce():Z(),N=""}function ee(M,x){M!==""&&(W.startScope(x),W.addText(M),W.endScope())}function dt(M,x){let E=1;const O=x.length-1;for(;E<=O;){if(!M._emit[E]){E++;continue}const q=te.classNameAliases[M[E]]||M[E],ne=x[E];q?ee(ne,q):(N=ne,Z(),N=""),E++}}function pt(M,x){return M.scope&&typeof M.scope=="string"&&W.openNode(te.classNameAliases[M.scope]||M.scope),M.beginScope&&(M.beginScope._wrap?(ee(N,te.classNameAliases[M.beginScope._wrap]||M.beginScope._wrap),N=""):M.beginScope._multi&&(dt(M.beginScope,x),N="")),w=Object.create(M,{parent:{value:w}}),w}function ft(M,x,E){let O=Si(M.endRe,E);if(O){if(M["on:end"]){const q=new It(M);M["on:end"](x,q),q.isMatchIgnored&&(O=!1)}if(O){for(;M.endsParent&&M.parent;)M=M.parent;return M}}if(M.endsWithParent)return ft(M.parent,x,E)}function yn(M){return w.matcher.regexIndex===0?(N+=M[0],1):(Ke=!0,0)}function bn(M){const x=M[0],E=M.rule,O=new It(E),q=[E.__beforeBegin,E["on:begin"]];for(const ne of q)if(ne&&(ne(M,O),O.isMatchIgnored))return yn(x);return E.skip?N+=x:(E.excludeBegin&&(N+=x),Y(),!E.returnBegin&&!E.excludeBegin&&(N=x)),pt(E,M),E.returnBegin?0:x.length}function Mn(M){const x=M[0],E=k.substring(M.index),O=ft(w,M,E);if(!O)return jt;const q=w;w.endScope&&w.endScope._wrap?(Y(),ee(x,w.endScope._wrap)):w.endScope&&w.endScope._multi?(Y(),dt(w.endScope,M)):q.skip?N+=x:(q.returnEnd||q.excludeEnd||(N+=x),Y(),q.excludeEnd&&(N=x));do w.scope&&W.closeNode(),!w.skip&&!w.subLanguage&&(_e+=w.relevance),w=w.parent;while(w!==O.parent);return O.starts&&pt(O.starts,M),q.returnEnd?0:x.length}function kn(){const M=[];for(let x=w;x!==te;x=x.parent)x.scope&&M.unshift(x.scope);M.forEach(x=>W.openNode(x))}let Oe={};function ht(M,x){const E=x&&x[0];if(N+=M,E==null)return Y(),0;if(Oe.type==="begin"&&x.type==="end"&&Oe.index===x.index&&E===""){if(N+=k.slice(x.index,x.index+1),!r){const O=new Error(`0 width match regex (${m})`);throw O.languageName=m,O.badRule=Oe.rule,O}return 1}if(Oe=x,x.type==="begin")return bn(x);if(x.type==="illegal"&&!A){const O=new Error('Illegal lexeme "'+E+'" for mode "'+(w.scope||"<unnamed>")+'"');throw O.mode=w,O}else if(x.type==="end"){const O=Mn(x);if(O!==jt)return O}if(x.type==="illegal"&&E==="")return 1;if(Fe>1e5&&Fe>x.index*3)throw new Error("potential infinite loop, way more iterations than matches");return N+=E,E.length}const te=j(m);if(!te)throw fe(o.replace("{}",m)),new Error('Unknown language: "'+m+'"');const xn=ia(te);let ze="",w=C||xn;const gt={},W=new a.__emitter(a);kn();let N="",_e=0,ce=0,Fe=0,Ke=!1;try{if(te.__emitTokens)te.__emitTokens(k,W);else{for(w.matcher.considerAll();;){Fe++,Ke?Ke=!1:w.matcher.considerAll(),w.matcher.lastIndex=ce;const M=w.matcher.exec(k);if(!M)break;const x=k.substring(ce,M.index),E=ht(x,M);ce=M.index+E}ht(k.substring(ce))}return W.finalize(),ze=W.toHTML(),{language:m,value:ze,relevance:_e,illegal:!1,_emitter:W,_top:w}}catch(M){if(M.message&&M.message.includes("Illegal"))return{language:m,value:Ge(k),illegal:!0,relevance:0,_illegalBy:{message:M.message,index:ce,context:k.slice(ce-100,ce+100),mode:M.mode,resultSoFar:ze},_emitter:W};if(r)return{language:m,value:Ge(k),illegal:!1,relevance:0,errorRaised:M,_emitter:W,_top:w};throw M}}function p(m){const k={value:Ge(m),illegal:!1,relevance:0,_top:i,_emitter:new a.__emitter(a)};return k._emitter.addText(m),k}function h(m,k){k=k||a.languages||Object.keys(t);const A=p(m),C=k.filter(j).filter(V).map(Y=>d(Y,m,!1));C.unshift(A);const L=C.sort((Y,ee)=>{if(Y.relevance!==ee.relevance)return ee.relevance-Y.relevance;if(Y.language&&ee.language){if(j(Y.language).supersetOf===ee.language)return 1;if(j(ee.language).supersetOf===Y.language)return-1}return 0}),[X,Z]=L,Ce=X;return Ce.secondBest=Z,Ce}function b(m,k,A){const C=k&&n[k]||A;m.classList.add("hljs"),m.classList.add(`language-${C}`)}function f(m){let k=null;const A=c(m);if(l(A))return;if(re("before:highlightElement",{el:m,language:A}),m.dataset.highlighted){console.log("Element previously highlighted. To highlight again, first unset `dataset.highlighted`.",m);return}if(m.children.length>0&&(a.ignoreUnescapedHTML||(console.warn("One of your code blocks includes unescaped HTML. This is a potentially serious security risk."),console.warn("https://github.com/highlightjs/highlight.js/wiki/security"),console.warn("The element with unescaped HTML:"),console.warn(m)),a.throwUnescapedHTML))throw new ca("One of your code blocks includes unescaped HTML.",m.innerHTML);k=m;const C=k.textContent,L=A?u(C,{language:A,ignoreIllegals:!0}):h(C);m.innerHTML=L.value,m.dataset.highlighted="yes",b(m,A,L.language),m.result={language:L.language,re:L.relevance,relevance:L.relevance},L.secondBest&&(m.secondBest={language:L.secondBest.language,relevance:L.secondBest.relevance}),re("after:highlightElement",{el:m,result:L,text:C})}function g(m){a=Dt(a,m)}const y=()=>{T(),ye("10.6.0","initHighlighting() deprecated.  Use highlightAll() now.")};function v(){T(),ye("10.6.0","initHighlightingOnLoad() deprecated.  Use highlightAll() now.")}let S=!1;function T(){if(document.readyState==="loading"){S=!0;return}document.querySelectorAll(a.cssSelector).forEach(f)}function I(){S&&T()}typeof window!="undefined"&&window.addEventListener&&window.addEventListener("DOMContentLoaded",I,!1);function H(m,k){let A=null;try{A=k(e)}catch(C){if(fe("Language definition for '{}' could not be registered.".replace("{}",m)),r)fe(C);else throw C;A=i}A.name||(A.name=m),t[m]=A,A.rawDefinition=k.bind(null,e),A.aliases&&_(A.aliases,{languageName:m})}function U(m){delete t[m];for(const k of Object.keys(n))n[k]===m&&delete n[k]}function K(){return Object.keys(t)}function j(m){return m=(m||"").toLowerCase(),t[m]||t[n[m]]}function _(m,{languageName:k}){typeof m=="string"&&(m=[m]),m.forEach(A=>{n[A.toLowerCase()]=k})}function V(m){const k=j(m);return k&&!k.disableAutodetect}function ae(m){m["before:highlightBlock"]&&!m["before:highlightElement"]&&(m["before:highlightElement"]=k=>{m["before:highlightBlock"](Object.assign({block:k.el},k))}),m["after:highlightBlock"]&&!m["after:highlightElement"]&&(m["after:highlightElement"]=k=>{m["after:highlightBlock"](Object.assign({block:k.el},k))})}function Se(m){ae(m),s.push(m)}function Te(m){const k=s.indexOf(m);k!==-1&&s.splice(k,1)}function re(m,k){const A=m;s.forEach(function(C){C[A]&&C[A](k)})}function le(m){return ye("10.7.0","highlightBlock will be removed entirely in v12.0"),ye("10.7.0","Please use highlightElement now."),f(m)}Object.assign(e,{highlight:u,highlightAuto:h,highlightAll:T,highlightElement:f,highlightBlock:le,configure:g,initHighlighting:y,initHighlightingOnLoad:v,registerLanguage:H,unregisterLanguage:U,listLanguages:K,getLanguage:j,registerAliases:_,autoDetection:V,inherit:Dt,addPlugin:Se,removePlugin:Te}),e.debugMode=function(){r=!1},e.safeMode=function(){r=!0},e.versionString=la,e.regex={concat:me,lookahead:on,either:lt,optional:Ai,anyNumberOfTimes:vi};for(const m in Ie)typeof Ie[m]=="object"&&sn(Ie[m]);return Object.assign(e,Ie),e},ke=gn({});ke.newInstance=()=>gn({});var da=ke;ke.HighlightJS=ke;ke.default=ke;var pa=bi(da);function mn(e,t=[]){return e.map(n=>{const s=[...t,...n.properties?n.properties.className:[]];return n.children?mn(n.children,s):{text:n.value,classes:s}}).flat()}function Wt(e){return e.value||e.children||[]}function fa(e){return!!pa.getLanguage(e)}function zt({doc:e,name:t,lowlight:n,defaultLanguage:s}){const r=[];return Qe(e,o=>o.type.name===t).forEach(o=>{var i;let a=o.pos+1;const l=o.node.attrs.language||s,c=n.listLanguages(),u=l&&(c.includes(l)||fa(l)||!((i=n.registered)===null||i===void 0)&&i.call(n,l))?Wt(n.highlight(l,o.node.textContent)):Wt(n.highlightAuto(o.node.textContent));mn(u).forEach(d=>{const p=a+d.text.length;if(d.classes.length){const h=Ye.inline(a,p,{class:d.classes.join(" ")});r.push(h)}a=p})}),Ze.create(e,r)}function ha(e){return typeof e=="function"}function ga({name:e,lowlight:t,defaultLanguage:n}){if(!["highlight","highlightAuto","listLanguages"].every(r=>ha(t[r])))throw Error("You should provide an instance of lowlight to use the code-block-lowlight extension");const s=new J({key:new Q("lowlight"),state:{init:(r,{doc:o})=>zt({doc:o,name:e,lowlight:t,defaultLanguage:n}),apply:(r,o,i,a)=>{const l=i.selection.$head.parent.type.name,c=a.selection.$head.parent.type.name,u=Qe(i.doc,p=>p.type.name===e),d=Qe(a.doc,p=>p.type.name===e);return r.docChanged&&([l,c].includes(e)||d.length!==u.length||r.steps.some(p=>p.from!==void 0&&p.to!==void 0&&u.some(h=>h.pos>=p.from&&h.pos+h.node.nodeSize<=p.to)))?zt({doc:r.doc,name:e,lowlight:t,defaultLanguage:n}):o.map(r.mapping,r.doc)}},props:{decorations(r){return s.getState(r)}}});return s}nn.extend({addOptions(){var e;return{...(e=this.parent)===null||e===void 0?void 0:e.call(this),lowlight:{},languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},addProseMirrorPlugins(){var e;return[...((e=this.parent)===null||e===void 0?void 0:e.call(this))||[],ga({name:this.name,lowlight:this.options.lowlight,defaultLanguage:this.options.defaultLanguage})]}});function ma(e){var t;const{char:n,allowSpaces:s,allowToIncludeChar:r,allowedPrefixes:o,startOfLine:i,$position:a}=e,l=s&&!r,c=to(n),u=new RegExp(`\\s${c}$`),d=i?"^":"",p=r?"":c,h=l?new RegExp(`${d}${c}.*?(?=\\s${p}|$)`,"gm"):new RegExp(`${d}(?:^)?${c}[^\\s${p}]*`,"gm"),b=((t=a.nodeBefore)===null||t===void 0?void 0:t.isText)&&a.nodeBefore.text;if(!b)return null;const f=a.pos-b.length,g=Array.from(b.matchAll(h)).pop();if(!g||g.input===void 0||g.index===void 0)return null;const y=g.input.slice(Math.max(0,g.index-1),g.index),v=new RegExp(`^[${o==null?void 0:o.join("")}\0]?$`).test(y);if(o!==null&&!v)return null;const S=f+g.index;let T=S+g[0].length;return l&&u.test(b.slice(T-1,T+1))&&(g[0]+=" ",T+=1),S<a.pos&&T>=a.pos?{range:{from:S,to:T},query:g[0].slice(n.length),text:g[0]}:null}const ya=new Q("suggestion");function ba({pluginKey:e=ya,editor:t,char:n="@",allowSpaces:s=!1,allowToIncludeChar:r=!1,allowedPrefixes:o=[" "],startOfLine:i=!1,decorationTag:a="span",decorationClass:l="suggestion",command:c=()=>null,items:u=()=>[],render:d=()=>({}),allow:p=()=>!0,findSuggestionMatch:h=ma}){let b;const f=d==null?void 0:d(),g=new J({key:e,view(){return{update:async(y,v)=>{var S,T,I,H,U,K,j;const _=(S=this.key)===null||S===void 0?void 0:S.getState(v),V=(T=this.key)===null||T===void 0?void 0:T.getState(y.state),ae=_.active&&V.active&&_.range.from!==V.range.from,Se=!_.active&&V.active,Te=_.active&&!V.active,re=!Se&&!Te&&_.query!==V.query,le=Se||ae&&re,m=re||ae,k=Te||ae&&re;if(!le&&!m&&!k)return;const A=k&&!le?_:V,C=y.dom.querySelector(`[data-decoration-id="${A.decorationId}"]`);b={editor:t,range:A.range,query:A.query,text:A.text,items:[],command:L=>c({editor:t,range:A.range,props:L}),decorationNode:C,clientRect:C?()=>{var L;const{decorationId:X}=(L=this.key)===null||L===void 0?void 0:L.getState(t.state),Z=y.dom.querySelector(`[data-decoration-id="${X}"]`);return(Z==null?void 0:Z.getBoundingClientRect())||null}:null},le&&((I=f==null?void 0:f.onBeforeStart)===null||I===void 0||I.call(f,b)),m&&((H=f==null?void 0:f.onBeforeUpdate)===null||H===void 0||H.call(f,b)),(m||le)&&(b.items=await u({editor:t,query:A.query})),k&&((U=f==null?void 0:f.onExit)===null||U===void 0||U.call(f,b)),m&&((K=f==null?void 0:f.onUpdate)===null||K===void 0||K.call(f,b)),le&&((j=f==null?void 0:f.onStart)===null||j===void 0||j.call(f,b))},destroy:()=>{var y;b&&((y=f==null?void 0:f.onExit)===null||y===void 0||y.call(f,b))}}},state:{init(){return{active:!1,range:{from:0,to:0},query:null,text:null,composing:!1}},apply(y,v,S,T){const{isEditable:I}=t,{composing:H}=t.view,{selection:U}=y,{empty:K,from:j}=U,_={...v};if(_.composing=H,I&&(K||t.view.composing)){(j<v.range.from||j>v.range.to)&&!H&&!v.composing&&(_.active=!1);const V=h({char:n,allowSpaces:s,allowToIncludeChar:r,allowedPrefixes:o,startOfLine:i,$position:U.$from}),ae=`id_${Math.floor(Math.random()*4294967295)}`;V&&p({editor:t,state:T,range:V.range,isActive:v.active})?(_.active=!0,_.decorationId=v.decorationId?v.decorationId:ae,_.range=V.range,_.query=V.query,_.text=V.text):_.active=!1}else _.active=!1;return _.active||(_.decorationId=null,_.range={from:0,to:0},_.query=null,_.text=null),_}},props:{handleKeyDown(y,v){var S;const{active:T,range:I}=g.getState(y.state);return T&&((S=f==null?void 0:f.onKeyDown)===null||S===void 0?void 0:S.call(f,{view:y,event:v,range:I}))||!1},decorations(y){const{active:v,range:S,decorationId:T}=g.getState(y);return v?Ze.create(y.doc,[Ye.inline(S.from,S.to,{nodeName:a,class:l,"data-decoration-id":T})]):null}}});return g}const Ma=new Q("mention");B.create({name:"mention",priority:101,addOptions(){return{HTMLAttributes:{},renderText({options:e,node:t}){var n;return`${e.suggestion.char}${(n=t.attrs.label)!==null&&n!==void 0?n:t.attrs.id}`},deleteTriggerWithBackspace:!1,renderHTML({options:e,node:t}){var n;return["span",R(this.HTMLAttributes,e.HTMLAttributes),`${e.suggestion.char}${(n=t.attrs.label)!==null&&n!==void 0?n:t.attrs.id}`]},suggestion:{char:"@",pluginKey:Ma,command:({editor:e,range:t,props:n})=>{var s,r,o;const i=e.view.state.selection.$to.nodeAfter;((s=i==null?void 0:i.text)===null||s===void 0?void 0:s.startsWith(" "))&&(t.to+=1),e.chain().focus().insertContentAt(t,[{type:this.name,attrs:n},{type:"text",text:" "}]).run(),(o=(r=e.view.dom.ownerDocument.defaultView)===null||r===void 0?void 0:r.getSelection())===null||o===void 0||o.collapseToEnd()},allow:({state:e,range:t})=>{const n=e.doc.resolve(t.from),s=e.schema.nodes[this.name];return!!n.parent.type.contentMatch.matchType(s)}}}},group:"inline",inline:!0,selectable:!1,atom:!0,addAttributes(){return{id:{default:null,parseHTML:e=>e.getAttribute("data-id"),renderHTML:e=>e.id?{"data-id":e.id}:{}},label:{default:null,parseHTML:e=>e.getAttribute("data-label"),renderHTML:e=>e.label?{"data-label":e.label}:{}}}},parseHTML(){return[{tag:`span[data-type="${this.name}"]`}]},renderHTML({node:e,HTMLAttributes:t}){if(this.options.renderLabel!==void 0)return console.warn("renderLabel is deprecated use renderText and renderHTML instead"),["span",R({"data-type":this.name},this.options.HTMLAttributes,t),this.options.renderLabel({options:this.options,node:e})];const n={...this.options};n.HTMLAttributes=R({"data-type":this.name},this.options.HTMLAttributes,t);const s=this.options.renderHTML({options:n,node:e});return typeof s=="string"?["span",R({"data-type":this.name},this.options.HTMLAttributes,t),s]:s},renderText({node:e}){return this.options.renderLabel!==void 0?(console.warn("renderLabel is deprecated use renderText and renderHTML instead"),this.options.renderLabel({options:this.options,node:e})):this.options.renderText({options:this.options,node:e})},addKeyboardShortcuts(){return{Backspace:()=>this.editor.commands.command(({tr:e,state:t})=>{let n=!1;const{selection:s}=t,{empty:r,anchor:o}=s;return r?(t.doc.nodesBetween(o-1,o,(i,a)=>{if(i.type.name===this.name)return n=!0,e.insertText(this.options.deleteTriggerWithBackspace?"":this.options.suggestion.char||"",a,a+i.nodeSize),!1}),n):!1})}},addProseMirrorPlugins(){return[ba({editor:this.editor,...this.options.suggestion})]}});export{D as E,vo as H,$a as L,se as M,Na as N,ba as S,Ia as V,B as a,Yr as b,no as c,tt as g,R as m,Ra as n,Je as t};
