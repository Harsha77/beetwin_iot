import{l as r,B as h,b as v,c as n,a as e,t as a,f as u,C as I,D as N,o as d}from"./@vue-OOCCUuA2.js";import{u as E}from"./vue-router-DLGjB-Pd.js";import{a as L}from"./axios-ByivMYyX.js";import{s as D}from"./index-BRhnRqUZ.js";import{b as G,a as z}from"./frappe-ui-zGBT8rMX.js";import"./@tiptap-BUCYMH7K.js";import"./showdown-D8SulXxm.js";import"./socket.io-client-De6w114h.js";/* empty css                */import"./prosemirror-state-DgsmxDjm.js";import"./prosemirror-model-C_7RDaDb.js";import"./prosemirror-transform-DoYUQK9o.js";import"./idb-keyval-BrH4ksw2.js";import"./prosemirror-dropcursor-BfstMEHz.js";import"./prosemirror-gapcursor-DAo5-j_C.js";import"./prosemirror-keymap-CVi9LBYH.js";import"./w3c-keyname-_MXnRwJa.js";import"./prosemirror-view-W--SXXbD.js";import"./prosemirror-history-DKyN9Nbl.js";import"./rope-sequence-DGojYqW9.js";import"./prosemirror-tables-DrV9oBPp.js";import"./linkifyjs-Bb8FdQht.js";import"./prosemirror-commands-Lnq4s3Q2.js";import"./prosemirror-schema-list-B9x1aVA0.js";import"./engine.io-client-CveMJrUI.js";import"./engine.io-parser-6vJSFETq.js";import"./@socket.io-Dkula2eQ.js";import"./socket.io-parser-D89bkXp7.js";const $="/assets/beetwin_iot/vertive/IOtweet%20Logo_2.0%20white.png",S="/assets/beetwin_iot/vertive/gauge.png",Q="/assets/beetwin_iot/vertive/Battery-1.png",Y={class:"min-h-screen flex flex-col"},J={class:"fixed top-0 left-0 w-full flex items-center justify-between py-4 border-b bg-[#08444c] shadow px-5 z-50"},K={class:"bg-gray-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold"},X=["src"],Z={key:0,class:"absolute right-0 mt-2 w-64 bg-white rounded-md shadow-lg z-20"},tt={class:"block px-4 py-2 text-gray-700 font-semibold break-all"},et={key:1,class:"fixed inset-0 flex items-center justify-center bg-gray-900 bg-opacity-50"},st={class:"bg-white p-6 rounded-md w-96"},ot={key:0,class:"text-red-500 mt-2"},rt={key:1,class:"text-green-500 mt-2"},at={class:"flex-grow flex flex-col md:flex-row"},lt={key:0,class:"flex-grow p-6 pt-16"},nt={class:"mt-4"},dt={class:"bg-[#08444c] min-h-screen p-4 text-white font-sans"},ut={class:"bg-[#08444c] rounded-md p-2 text-center text-sm mb-4"},it={class:"text-white flex-1 text-center font-bold text-xl"},pt={class:"bg-white text-black rounded-md p-6 shadow-md"},gt={class:"grid grid-cols-3 items-start"},bt={class:"text-center"},mt={class:"overflow-x-auto inline-block"},ct={class:"table-auto border border-green-600"},wt={key:0},ft={class:"border border-green-600"},xt={class:"border border-green-600 px-4 py-2"},_t={class:"border border-green-600"},yt={class:"border border-green-600 px-4 py-2"},ht={class:"border border-green-600"},vt={class:"border border-green-600 px-4 py-2"},It={class:"text-center"},Nt={class:"overflow-x-auto inline-block"},Vt={class:"table-auto border border-green-600"},At={key:0},Pt={class:"border border-green-600"},kt={class:"border border-green-600 px-4 py-2"},Ot={class:"border border-green-600"},Ct={class:"border border-green-600 px-4 py-2"},Lt={class:"text-center"},Dt={class:"overflow-x-auto inline-block"},St={class:"table-auto border border-green-600"},Bt={key:0},Ut={class:"border border-green-600"},Ft={class:"border border-green-600 px-4 py-2"},Tt={class:"border border-green-600"},Ht={class:"border border-green-600 px-4 py-2"},Rt={class:"border border-green-600"},qt={class:"border border-green-600 px-4 py-2"},Mt={class:"border border-green-600"},Wt={class:"border border-green-600 px-4 py-2"},jt={class:"bg-white text-black rounded-md p-4 mt-6 shadow-md"},Et={class:"flex justify-between mb-2 text-sm"},Gt={class:"font-semibold"},zt={class:"w-full text-sm border border-gray-200"},$t={key:0,class:"border-t"},Qt={class:"p-2 flex items-center gap-2"},Yt={class:"border border-green-600 px-4 py-2 alert-blink"},Jt={key:0},Kt={key:1},Xt={__name:"Home",setup(Zt){const b=r("/User.png");z({url:"/api/method/frappe.auth.get_logged_user",auto:!0,onSuccess:async s=>{if(s){const t=await B(s.message),l=(t==null?void 0:t.user_image)||U()||"/User.png";b.value=l,window.user_image_path=l,console.log("Image Path:",l)}}});const B=async s=>{const t=await fetch(`/api/resource/User/${s}`);return t.ok?await t.json():null},U=()=>{const s=document.cookie.match(/user_image=([^;]+)/);return s?decodeURIComponent(s[1]):null};h(()=>{window.user_image_path&&(b.value=window.user_image_path)}),E();const o=r([]),F=r(""),w=r(10),T=r(1),f=r(!1),x=r(""),g=r(""),_=r(""),m=r(""),y=r(""),H=async()=>{var s,t,l;if(m.value!==y.value){g.value="Passwords do not match.";return}try{const i=await L.post("/api/method/beetwin_iot.beetwin_iot.api.changedpassword.admin_change_password",{user:V.value,old_password:_.value,new_password:m.value});i.data.message==="Password Updated"?(x.value="Password changed successfully.",setTimeout(()=>{console.log("Closing modal..."),f.value=!1},1500)):g.value=i.data.message||"Unexpected error."}catch(i){console.error("API Error:",(s=i.response)==null?void 0:s.data),g.value=((l=(t=i.response)==null?void 0:t.data)==null?void 0:l.message)||"Failed to update password."}},R=s=>{const l=document.cookie.split("; ").find(i=>i.startsWith(s+"="));return l?decodeURIComponent(l.split("=")[1]):null};h(()=>{const s=R("user_image");s&&(b.value=`/api/method/frappe.utils.print_format.download_pdf?file_url=${s}`)});const q=r(2),c=r(!1),M=()=>{c.value=!c.value};function W(){D.logout.submit(),c.value=!1}const V=r(D.user||"Guest"),j=v(()=>o.value.filter(s=>s.serialNumber.toString().includes(F.value.trim())).sort((s,t)=>s.serialNumber.localeCompare(t.serialNumber)));v(()=>{const s=(T.value-1)*w.value;return j.value.slice(s,s+w.value)}),v(()=>Math.ceil(o.value.length/w.value));const A=async()=>{try{const s=await L.get("/api/method/beetwin_iot.beetwin_iot.api.get_latest_device_data_vertiv.get_filtered_device_data");console.log("API Response from Cloud:",s.data),s.data&&s.data.message&&s.data.message.status==="success"?o.value=s.data.message.data.filter(t=>t&&(t["Serial Number"]||t["Input Voltage"]||t["Input Current"]||t["Input Freq"]||t["Output Voltage"]||t["Output Current"]||t["Output Load"]||t["Output Freq"]||t["Output VA"]||t["Output Watts"]||t["Output Load"]||t["Output VA"]||t.Watts||t["Output Freq"]||t["Battry Volatge"]||t["Battery Charge"]||t["Time Remaining"]||t["Input Volatge High"]||t["Input Volatge Low"])).map(t=>({deviceId:t["Device ID"]||"N/A",serialNumber:t["Serial Number"]?t["Serial Number"].toString():"N/A",timestamp:t.Timestamp?t.Timestamp.slice(0,19):"N/A",latestData:{INPV:t["Input Voltage"]?t["Input Voltage"].toString():"N/A",INPI:t["Input Current"]?t["Input Current"].toString():"N/A",INF:t["Input Freq"]?t["Input Freq"].toString():"N/A",OPV:t["Output Voltage"]?t["Output Voltage"].toString():"N/A",OPI:t["Output Current"]?t["Output Current"].toString():"N/A",OPL:t["Output Load"]?t["Output Load"].toString():"N/A",OPVA:t["Output VA"]?t["Output VA"].toString():"N/A",OPW:t.Watts?t.Watts.toString():"N/A",OPF:t["Output Freq"]?t["Output Freq"].toString():"N/A",BTV:t["Battry Volatge"]?t["Battry Volatge"].toString():"N/A",BTC:t["Battery Charge"]?t["Battery Charge"].toString():"N/A",BT:t["Time Remaining"]?t["Time Remaining"].toString():"N/A",ALINPVHI:t["Input Volatge High"]?t["Input Volatge High"].toString():"N/A",ALINPVLOW:t["Input Volatge Low"]?t["Input Volatge Low"].toString():"N/A"}})):console.error("Invalid API response:",s.data)}catch(s){console.error("Error fetching devices:",s)}};return h(()=>{A(),setInterval(()=>{A()},1e4)}),(s,t)=>{var l,i,P,k,O,C;return d(),n("div",Y,[e("header",J,[t[7]||(t[7]=e("img",{src:$,alt:"IoTweet Logo",class:"w-28"},null,-1)),t[8]||(t[8]=e("div",{class:"text-white flex-1 text-center font-bold text-xl"},"VERTIV ENERGY DASHBOARD",-1)),e("button",{onClick:t[0]||(t[0]=(...p)=>s.toggleSidebar&&s.toggleSidebar(...p)),class:"lg:hidden text-white ml-auto"},t[5]||(t[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"})],-1)])),e("div",{class:"relative ml-4",onClick:M},[e("button",K,[e("img",{src:b.value,alt:"User Image",class:"w-full h-full object-cover rounded-full"},null,8,X)]),c.value?(d(),n("div",Z,[e("p",tt,a(V.value),1),e("a",{href:"#",onClick:W,class:"block px-4 py-2 text-gray-700 hover:bg-gray-100"},"Logout")])):u("",!0),f.value?(d(),n("div",et,[e("div",st,[t[6]||(t[6]=e("h2",{class:"text-xl font-bold mb-4"},"Change Password",-1)),I(e("input",{"onUpdate:modelValue":t[1]||(t[1]=p=>_.value=p),type:"password",placeholder:"Current Password",class:"w-full p-2 border rounded-md mb-2"},null,512),[[N,_.value]]),I(e("input",{"onUpdate:modelValue":t[2]||(t[2]=p=>m.value=p),type:"password",placeholder:"New Password",class:"w-full p-2 border rounded-md mb-2"},null,512),[[N,m.value]]),I(e("input",{"onUpdate:modelValue":t[3]||(t[3]=p=>y.value=p),type:"password",placeholder:"Confirm New Password",class:"w-full p-2 border rounded-md mb-4"},null,512),[[N,y.value]]),e("button",{onClick:H,class:"w-full bg-blue-500 text-white p-2 rounded-md"},"Update Password"),e("button",{onClick:t[4]||(t[4]=p=>f.value=!1),class:"w-full mt-2 text-gray-600"},"Cancel"),g.value?(d(),n("p",ot,a(g.value),1)):u("",!0),x.value?(d(),n("p",rt,a(x.value),1)):u("",!0)])])):u("",!0)])]),e("main",at,[q.value===2?(d(),n("div",lt,[e("div",nt,[t[36]||(t[36]=e("div",{class:"flex justify-end mb-2"},null,-1)),e("div",dt,[e("div",ut,[e("span",it,"Updated: "+a(((l=o.value[0])==null?void 0:l.timestamp)||"N/A"),1)]),e("div",pt,[e("div",gt,[e("div",bt,[t[15]||(t[15]=e("img",{src:S,alt:"Input Gauge",class:"w-24 h-16 mb-2 mx-auto"},null,-1)),t[16]||(t[16]=e("p",{class:"font-bold mb-2"},"Input",-1)),e("div",mt,[e("table",ct,[o.value.length>0?(d(),n("tbody",wt,[e("tr",ft,[t[9]||(t[9]=e("td",{class:"border border-green-600 px-4 py-2 font-bold"},"L-N",-1)),e("td",xt,a(o.value[0].latestData.INPV),1),t[10]||(t[10]=e("td",{class:"border border-green-600 px-4 py-2"},"VAC",-1))]),e("tr",_t,[t[11]||(t[11]=e("td",{class:"border border-green-600 px-4 py-2 font-bold"},"Amps",-1)),e("td",yt,a(o.value[0].latestData.INPI),1),t[12]||(t[12]=e("td",{class:"border border-green-600 px-4 py-2"},"A",-1))]),e("tr",ht,[t[13]||(t[13]=e("td",{class:"border border-green-600 px-4 py-2 font-bold"},"Freq",-1)),e("td",vt,a(o.value[0].latestData.INF),1),t[14]||(t[14]=e("td",{class:"border border-green-600 px-4 py-2"},"Hz",-1))])])):u("",!0)])])]),e("div",It,[t[21]||(t[21]=e("img",{src:Q,alt:"Input Gauge",class:"w-24 h-16 mb-2 mx-auto"},null,-1)),t[22]||(t[22]=e("p",{class:"font-bold mb-2"},"Battery",-1)),e("div",Nt,[e("table",Vt,[o.value.length>0?(d(),n("tbody",At,[e("tr",Pt,[t[17]||(t[17]=e("td",{class:"border border-green-600 px-4 py-2 font-bold"},"Voltage",-1)),e("td",kt,a(o.value[0].latestData.BTV),1),t[18]||(t[18]=e("td",{class:"border border-green-600 px-4 py-2"},"VDC",-1))]),e("tr",Ot,[t[19]||(t[19]=e("td",{class:"border border-green-600 px-4 py-2 font-bold"},"Charge",-1)),e("td",Ct,a(o.value[0].latestData.BTC),1),t[20]||(t[20]=e("td",{class:"border border-green-600 px-4 py-2"},"%",-1))])])):u("",!0)])])]),e("div",Lt,[t[31]||(t[31]=e("img",{src:S,alt:"Input Gauge",class:"w-24 h-16 mb-2 mx-auto"},null,-1)),t[32]||(t[32]=e("p",{class:"font-bold mb-2"},"Output",-1)),e("div",Dt,[e("table",St,[o.value.length>0?(d(),n("tbody",Bt,[e("tr",Ut,[t[23]||(t[23]=e("td",{class:"border border-green-600 px-4 py-2 font-bold"},"L-N",-1)),e("td",Ft,a(o.value[0].latestData.OPV),1),t[24]||(t[24]=e("td",{class:"border border-green-600 px-4 py-2"},"VAC",-1))]),e("tr",Tt,[t[25]||(t[25]=e("td",{class:"border border-green-600 px-4 py-2 font-bold"},"Amps",-1)),e("td",Ht,a(o.value[0].latestData.OPI),1),t[26]||(t[26]=e("td",{class:"border border-green-600 px-4 py-2"},"A",-1))]),e("tr",Rt,[t[27]||(t[27]=e("td",{class:"border border-green-600 px-4 py-2 font-bold"},"Load",-1)),e("td",qt,a(o.value[0].latestData.OPL),1),t[28]||(t[28]=e("td",{class:"border border-green-600 px-4 py-2"},"%",-1))]),e("tr",Mt,[t[29]||(t[29]=e("td",{class:"border border-green-600 px-4 py-2 font-bold"},"Freq",-1)),e("td",Wt,a(o.value[0].latestData.OPF),1),t[30]||(t[30]=e("td",{class:"border border-green-600 px-4 py-2"},"Hz",-1))])])):u("",!0)])])])]),e("div",jt,[e("div",Et,[e("span",Gt,"Alert Events Updated: "+a(((i=o.value[0])==null?void 0:i.timestamp)||"N/A"),1),t[33]||(t[33]=e("span",{class:"text-gray-500"},null,-1))]),e("table",zt,[t[35]||(t[35]=e("thead",{class:"bg-gray-100"},[e("tr")],-1)),e("tbody",null,[o.value.length>0&&(((P=o.value[0].latestData)==null?void 0:P.ALINPVHI)==="1"||((k=o.value[0].latestData)==null?void 0:k.ALINPVLOW)==="1")?(d(),n("tr",$t,[e("td",Qt,[t[34]||(t[34]=e("span",{class:"w-3 h-3 bg-yellow-400 rounded-full inline-block"},null,-1)),e("div",Yt,[((O=o.value[0].latestData)==null?void 0:O.ALINPVHI)==="1"?(d(),n("div",Jt,"High Input Voltage Alert")):u("",!0),((C=o.value[0].latestData)==null?void 0:C.ALINPVLOW)==="1"?(d(),n("div",Kt,"Low Input Voltage Alert")):u("",!0)])])])):u("",!0)])])])])])])])):u("",!0)])])}}},ke=G(Xt,[["__scopeId","data-v-da8c5011"]]);export{ke as default};
